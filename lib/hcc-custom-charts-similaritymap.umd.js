!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-force")):"function"==typeof define&&define.amd?define(["exports","d3-force"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).RawCharts_similaritymap={},t.d3Force)}(this,(function(t,e){"use strict";const r={name:"Similarity Map",id:"rawgraphs.similaritymap",categories:["Dimension Reduction","Clustering"],description:"Similarity of high dimensional data points is rendered in two dimensions via clustering. Different choices for a dimensionality reduction can be selected.",code:"https://observablehq.com/",tutorial:"https://rawgraphs.io/learning/",thumbnail:"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='320' height='160'%3e %3crect width='320' height='160' fill='white'/%3e %3ctext x='160' y='5' font-size='5.333333333333333' style='text-anchor: middle%3b'/%3e %3cg transform='translate(17%2c 5)'%3e %3cg fill='none' font-size='10' font-family='sans-serif' text-anchor='left' transform='translate(0%2c 0)'%3e %3cpath class='domain' stroke='currentColor' d='M-6%2c145H0V0H-6'/%3e %3cg class='tick' opacity='1' transform='translate(0%2c145)'%3e %3cline stroke='currentColor' x2='-6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(0%2c126.875)'%3e %3cline stroke='currentColor' x2='-6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(0%2c108.75)'%3e %3cline stroke='currentColor' x2='-6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(0%2c90.625)'%3e %3cline stroke='currentColor' x2='-6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(0%2c72.5)'%3e %3cline stroke='currentColor' x2='-6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(0%2c54.375)'%3e %3cline stroke='currentColor' x2='-6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(0%2c36.25)'%3e %3cline stroke='currentColor' x2='-6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(0%2c18.125)'%3e %3cline stroke='currentColor' x2='-6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(0%2c0)'%3e %3cline stroke='currentColor' x2='-6'/%3e %3c/g%3e %3c/g%3e %3cg fill='none' font-size='10' font-family='sans-serif' text-anchor='middle' transform='translate(0%2c 145)'%3e %3cpath class='domain' stroke='currentColor' d='M0%2c6V0H295V6'/%3e %3cg class='tick' opacity='1' transform='translate(0%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(22.692307692307693%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(45.38461538461539%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(68.07692307692308%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(90.76923076923077%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(113.46153846153847%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(136.15384615384616%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(158.84615384615384%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(181.53846153846155%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(204.23076923076923%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(226.92307692307693%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(249.6153846153846%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(272.3076923076923%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3cg class='tick' opacity='1' transform='translate(295%2c0)'%3e %3cline stroke='currentColor' y2='6'/%3e %3c/g%3e %3c/g%3e %3ccircle cx='273.8736808911053' cy='74.40196630577006' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='149.96546936590826' cy='60.94777214115873' r='3' fill='%230365a8'/%3e %3ccircle cx='24.97738129026033' cy='46.194956555991226' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='8.358495939070886' cy='42.19106925852386' r='3' fill='%230365a8'/%3e %3ccircle cx='134.62893805667133' cy='96.28347051010246' r='3' fill='%230365a8'/%3e %3ccircle cx='160.53485552955283' cy='72.53436919187398' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='138.08729635025702' cy='84.28367478526316' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='275.4827180004194' cy='95.13788397210972' r='3' fill='%230365a8'/%3e %3ccircle cx='5.397027263144434' cy='66.99220908391978' r='3' fill='%230365a8'/%3e %3ccircle cx='20.78679435237005' cy='85.21126372495291' r='3' fill='%230365a8'/%3e %3ccircle cx='132.92286353401437' cy='107.52659645139859' r='3' fill='%230365a8'/%3e %3ccircle cx='7.776077569522142' cy='66.53164059390448' r='3' fill='%230365a8'/%3e %3ccircle cx='10.633653421441295' cy='47.93041385278086' r='3' fill='%230365a8'/%3e %3ccircle cx='12.325662674901132' cy='97.82388130334378' r='3' fill='%230365a8'/%3e %3ccircle cx='142.1441588107749' cy='68.9361513582352' r='3' fill='%230365a8'/%3e %3ccircle cx='249.87903670518423' cy='128.30573101731792' r='3' fill='%230365a8'/%3e %3ccircle cx='46.46349637517749' cy='88.31492300761872' r='3' fill='%230365a8'/%3e %3ccircle cx='11.079477832941599' cy='55.79927728482929' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='13.896727927289591' cy='78.3052414802071' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='4.808443182475566' cy='78.21256382058364' r='3' fill='%230365a8'/%3e %3ccircle cx='275.62231672183657' cy='78.08294954015865' r='3' fill='%230365a8'/%3e %3ccircle cx='267.0533958941074' cy='115.27848499590678' r='3' fill='%230365a8'/%3e %3ccircle cx='60.90498453020562' cy='65.33374864073825' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='14.012527085832094' cy='42.484815971664254' r='3' fill='%230365a8'/%3e %3ccircle cx='212.025454600032' cy='94.86702249429159' r='3' fill='%230365a8'/%3e %3ccircle cx='137.38751410320017' cy='79.24470518723969' r='3' fill='%230365a8'/%3e %3ccircle cx='276.7138483998731' cy='83.12487497155008' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='59.33132672637574' cy='1.20494824704806' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='261.06622646099197' cy='117.61009030023436' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='248.19335565078185' cy='46.60246870802698' r='3' fill='%230365a8'/%3e %3ccircle cx='4.750652433892311' cy='86.31530620996608' r='3' fill='%230365a8'/%3e %3ccircle cx='149.69369758970214' cy='52.73109872274037' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='64.21748797654703' cy='52.76996737882524' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='11.515429357142752' cy='106.54902815180424' r='3' fill='%230365a8'/%3e %3ccircle cx='40.902413471952826' cy='12.767461103308188' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='209.02395537808238' cy='112.58546733347333' r='3' fill='%230365a8'/%3e %3ccircle cx='274.9674038556771' cy='99.3905578200699' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='1.777337758241187' cy='86.93791976441653' r='3' fill='%230365a8'/%3e %3ccircle cx='45.41039876707984' cy='87.77734334012138' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='264.8908967073647' cy='67.30330932577739' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='205.68584012277796' cy='121.26238313823794' r='3' fill='%230365a8'/%3e %3ccircle cx='212.38031576969206' cy='111.27205520785108' r='3' fill='%230365a8'/%3e %3ccircle cx='274.94239862987826' cy='77.5585101268849' r='3' fill='%230365a8'/%3e %3ccircle cx='261.81637913514334' cy='69.68998679490565' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='204.93166455944137' cy='108.5703340733092' r='3' fill='%230365a8'/%3e %3ccircle cx='9.705922793431842' cy='37.26337732811196' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='249.20747405288134' cy='46.61169708446175' r='3' fill='%230365a8'/%3e %3ccircle cx='268.3100259658669' cy='82.29951593688232' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='23.700103788459863' cy='18.67325067552772' r='3' fill='%230365a8'/%3e %3ccircle cx='141.90979009334902' cy='63.83990979182998' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='134.04023199612058' cy='112.46225364392177' r='3' fill='%230365a8'/%3e %3ccircle cx='255.34829679922663' cy='51.008670328621626' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='143.49100063419672' cy='75.36284897398632' r='3' fill='%230365a8'/%3e %3ccircle cx='215.11270216337246' cy='115.57216409425979' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='5.453510488764989' cy='55.17055670318107' r='3' fill='%230365a8'/%3e %3ccircle cx='226.99842082211802' cy='108.72213028680777' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='134.11771928331163' cy='111.83091424670219' r='3' fill='%230365a8'/%3e %3ccircle cx='215.53308510949887' cy='110.34642622211203' r='3' fill='%230365a8'/%3e %3ccircle cx='276.4617110819865' cy='91.60428501254137' r='3' fill='%230365a8'/%3e %3ccircle cx='17.811617974408986' cy='35.36876667362979' r='3' fill='%230365a8'/%3e %3ccircle cx='208.36818647150338' cy='120.06730457046625' r='3' fill='%230365a8'/%3e %3ccircle cx='276.18629778508074' cy='96.2798942676243' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='10.786852296393782' cy='84.43833776547896' r='3' fill='%230365a8'/%3e %3ccircle cx='59.310711533399584' cy='68.36860385214501' r='3' fill='%230365a8'/%3e %3ccircle cx='264.84875314773126' cy='62.70206658047842' r='3' fill='%230365a8'/%3e %3ccircle cx='196.08605552229565' cy='126.49919665560259' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='27.408446848107463' cy='41.05354540316835' r='3' fill='%230365a8'/%3e %3ccircle cx='257.0519726554794' cy='58.53587390555052' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='5.461173033894366' cy='69.97664443200806' r='3' fill='%230365a8'/%3e %3ccircle cx='67.37922276068774' cy='31.63375891249114' r='3' fill='%230365a8'/%3e %3ccircle cx='21.087477633986808' cy='91.8864426638924' r='3' fill='%230365a8'/%3e %3ccircle cx='7.402419937379039' cy='73.42689327144622' r='3' fill='%230365a8'/%3e %3ccircle cx='59.16924281627122' cy='1.546903868843212' r='3' fill='%230365a8'/%3e %3ccircle cx='215.0121348689453' cy='93.30594242633636' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='269.6625844832433' cy='109.36821484782966' r='3' fill='%230365a8'/%3e %3ccircle cx='146.8341610143131' cy='69.9864403439895' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='140.03696735907164' cy='81.65359578964356' r='3' fill='%230365a8'/%3e %3ccircle cx='250.69829063665037' cy='42.73395446239168' r='3' fill='%230365a8'/%3e %3ccircle cx='34.8685421577594' cy='17.87019304970827' r='3' fill='%230365a8'/%3e %3ccircle cx='271.87288975258883' cy='70.52911357297688' r='3' fill='%230365a8'/%3e %3ccircle cx='261.10704348039906' cy='116.87082995283758' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='34.97387392511166' cy='13.579817947498617' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='266.30457984495985' cy='73.09255332194545' r='3' fill='%230365a8'/%3e %3ccircle cx='219.58594613335288' cy='81.12324539361234' r='3' fill='%230365a8'/%3e %3ccircle cx='23.371121793013632' cy='24.038137518427572' r='3' fill='%230365a8'/%3e %3ccircle cx='68.46638659737903' cy='33.07854340826079' r='3' fill='%230365a8'/%3e %3ccircle cx='65.55189868973761' cy='54.00015477151045' r='3' fill='%230365a8'/%3e %3ccircle cx='28.45632119602194' cy='38.40052734305389' r='3' fill='%230365a8'/%3e %3ccircle cx='17.221790455022134' cy='35.55130853358268' r='3' fill='%230365a8'/%3e %3ccircle cx='11.182093202774496' cy='52.64723801862309' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='5.901167185407984' cy='89.59759009667894' r='3' fill='%230365a8'/%3e %3ccircle cx='18.86993872490133' cy='26.837256352094105' r='3' fill='%230365a8'/%3e %3ccircle cx='66.67120705973099' cy='49.05951980828462' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='12.507533350466135' cy='109.06851058422073' r='3' fill='%230365a8'/%3e %3ccircle cx='163.2633303323012' cy='40.13693011548889' r='3' fill='%230365a8'/%3e %3ccircle cx='2.265396760589349' cy='50.284391595123836' r='3' fill='%230365a8'/%3e %3ccircle cx='203.022653447339' cy='112.76073979452106' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='9.579775646099526' cy='87.42475868825791' r='3' fill='%230365a8'/%3e %3ccircle cx='202.63997174196203' cy='117.39463622322143' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='14.293018826121966' cy='30.93518596774428' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='135.65797718336685' cy='73.90699256568463' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='132.82859135397652' cy='96.09265821165418' r='3' fill='%230365a8'/%3e %3ccircle cx='271.0363348290813' cy='87.85055655847216' r='3' fill='%230365a8'/%3e %3ccircle cx='62.38872083608008' cy='59.606231398240794' r='3' fill='%230365a8'/%3e %3ccircle cx='14.073044500378977' cy='39.83057853670894' r='3' fill='%230365a8'/%3e %3ccircle cx='223.2323287374883' cy='75.52556188826706' r='3' fill='%230365a8'/%3e %3ccircle cx='266.0862450303154' cy='62.89807392403541' r='3' fill='%230365a8'/%3e %3ccircle cx='266.9379002156966' cy='115.70144321344692' r='3' fill='%230365a8'/%3e %3ccircle cx='134.93578735651886' cy='98.23276745487897' r='3' fill='%230365a8'/%3e %3ccircle cx='149.28693433686837' cy='66.57760874862649' r='3' fill='%230365a8'/%3e %3ccircle cx='139.70280058693126' cy='72.43925538149978' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='159.6309786239082' cy='45.59705464601828' r='3' fill='%230365a8'/%3e %3ccircle cx='132.95263232403565' cy='115.46460024526698' r='3' fill='%230365a8'/%3e %3ccircle cx='159.82533017668533' cy='45.274842208986705' r='3' fill='%230365a8'/%3e %3ccircle cx='12.076947271704226' cy='92.7823730806226' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='139.72657320267393' cy='64.52914869997306' r='3' fill='%230365a8'/%3e %3ccircle cx='188.73066580708016' cy='129.18476110569955' r='3' fill='%230365a8'/%3e %3ccircle cx='165.99297789951422' cy='39.236173888485055' r='3' fill='%230365a8'/%3e %3ccircle cx='266.9894331937218' cy='95.19120895866537' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='148.86526690819596' cy='76.7428491340657' r='3' fill='%230365a8'/%3e %3ccircle cx='133.12671647465746' cy='115.16481890402667' r='3' fill='%230365a8'/%3e %3ccircle cx='53.08328299274306' cy='76.37155635709775' r='3' fill='%230365a8'/%3e %3ccircle cx='234.3313056993177' cy='47.0181386341575' r='3' fill='%230365a8'/%3e %3ccircle cx='156.37209125557732' cy='44.678425748673234' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='267.19272646978663' cy='78.32916191981671' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='166.7009598065258' cy='40.4589212957464' r='3' fill='%230365a8'/%3e %3ccircle cx='215.69354038772084' cy='113.75276044258909' r='3' fill='%230365a8'/%3e %3ccircle cx='165.95528976079422' cy='40.84136995358617' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='59.0834936773774' cy='1.4616592766888026' r='3' fill='%230365a8'/%3e %3ccircle cx='22.244193670763142' cy='20.72518672304012' r='3' fill='%230365a8'/%3e %3ccircle cx='257.85559338237044' cy='57.94521885342723' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='58.92422099372109' cy='2.734273202446346' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='20.620153416365195' cy='43.84250769087906' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='215.23406397614917' cy='94.84480258479937' r='3' fill='%230365a8'/%3e %3ccircle cx='33.88569212907148' cy='18.48227507559019' r='3' fill='%230365a8'/%3e %3ccircle cx='145.850096946667' cy='58.39671590643399' r='3' fill='%230365a8'/%3e %3ccircle cx='65.01042632630984' cy='49.96558326903371' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='213.92533876335838' cy='101.11570576861618' r='3' fill='%230365a8'/%3e %3ccircle cx='2.0002393264479594' cy='92.26244308768662' r='3' fill='%230365a8'/%3e %3ccircle cx='228.91240927385297' cy='48.78529015447973' r='3' fill='%230365a8'/%3e %3ccircle cx='133.82095911794408' cy='93.30672727846228' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='5.204770633907305' cy='54.44083821531348' r='3' fill='%230365a8'/%3e %3ccircle cx='58.98489585823845' cy='1.4040309084316227' r='3' fill='%230365a8'/%3e %3ccircle cx='249.98093103145226' cy='48.184590948146464' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='61.18363951919209' cy='12.084341658514566' r='3' fill='%230365a8'/%3e %3ccircle cx='230.17447659343685' cy='69.74703231783127' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='11.290043507944576' cy='50.790128781957286' r='3' fill='%230365a8'/%3e %3ccircle cx='213.96680271750068' cy='117.27721297351978' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='147.89601562699377' cy='64.81652890126813' r='3' fill='%230365a8'/%3e %3ccircle cx='7.031242101294424' cy='101.82464057897171' r='3' fill='%230365a8'/%3e %3ccircle cx='275.26069093499837' cy='86.54400677402135' r='3' fill='%230365a8'/%3e %3ccircle cx='265.146207209418' cy='119.13970074095926' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='147.66480191470805' cy='69.31716074777874' r='3' fill='%230365a8'/%3e %3ccircle cx='205.2970340444743' cy='107.94506899329689' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='261.2508672597341' cy='119.92645090654501' r='3' fill='%230365a8'/%3e %3ccircle cx='214.59489658839144' cy='105.7312744825121' r='3' fill='%230365a8'/%3e %3ccircle cx='6.294438629405335' cy='97.09663860817648' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='12.351342066942545' cy='95.7307558996213' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='64.16969175315917' cy='52.958825175284176' r='3' fill='%230365a8'/%3e %3ccircle cx='142.03475048818441' cy='78.99887768016929' r='3' fill='%230365a8'/%3e %3ccircle cx='249.34279434585167' cy='40.808633088011796' r='3' fill='%230365a8'/%3e %3ccircle cx='270.6294634702203' cy='84.06506044775273' r='3' fill='%230365a8'/%3e %3ccircle cx='28.989521001445524' cy='22.096014073733727' r='3' fill='%230365a8'/%3e %3ccircle cx='209.26836871786233' cy='96.79925808449902' r='3' fill='%230365a8'/%3e %3ccircle cx='3.902208130632246' cy='48.58593238754574' r='3' fill='%230365a8'/%3e %3ccircle cx='188.2057379339547' cy='128.58738260807044' r='3' fill='%230365a8'/%3e %3ccircle cx='133.11157167562592' cy='115.17697227577314' r='3' fill='%230365a8'/%3e %3ccircle cx='214.70260926697094' cy='86.05493945385011' r='3' fill='%230365a8'/%3e %3ccircle cx='44.4147790661118' cy='90.75106021018996' r='3' fill='%230365a8'/%3e %3ccircle cx='54.03463048943922' cy='76.43888502049248' r='3' fill='%230365a8'/%3e %3ccircle cx='244.51894244000832' cy='36.55824601501418' r='3' fill='%230365a8'/%3e %3ccircle cx='230.15382483724883' cy='59.16243705343981' r='3' fill='%230365a8'/%3e %3ccircle cx='155.5541466377796' cy='48.3001415170008' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='5.094456259314035' cy='44.838247987746364' r='3' fill='%230365a8'/%3e %3ccircle cx='264.4499742438464' cy='110.20503602155719' r='3' fill='%230365a8'/%3e %3ccircle cx='210.69187419564446' cy='120.05625223349307' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='31.349970411908593' cy='11.489712654058382' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='256.4425956120276' cy='122.88382711686565' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='3.8178819450592294' cy='95.2652784407065' r='3' fill='%230365a8'/%3e %3ccircle cx='244.53920278485626' cy='35.230858327636874' r='3' fill='%230365a8'/%3e %3ccircle cx='273.01488800578176' cy='99.52574519224417' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='207.61858921531484' cy='114.86353635091156' r='3' fill='%230365a8'/%3e %3ccircle cx='238.59208965816217' cy='39.62006075609406' r='3' fill='%230365a8'/%3e %3ccircle cx='122.62282801773063' cy='120.82690611727132' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='7.878261974571921' cy='81.06045814426558' r='3' fill='%230365a8'/%3e %3ccircle cx='150.79663466511772' cy='58.11006470033386' r='3' fill='%230365a8'/%3e %3ccircle cx='30.553442227318897' cy='17.452208904912922' r='3' fill='%230365a8'/%3e %3ccircle cx='126.53434337991361' cy='119.64432422660805' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='218.9447348331046' cy='82.27116516206097' r='3' fill='%230365a8'/%3e %3ccircle cx='12.015526940050776' cy='93.05890457614018' r='3' fill='%230365a8'/%3e %3ccircle cx='132.3415813701124' cy='74.4433046210467' r='3' fill='%230365a8'/%3e %3ccircle cx='269.1900475745739' cy='97.03693528498731' r='3' fill='%230365a8'/%3e %3ccircle cx='271.6723316503875' cy='103.44834546972702' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='29.08690754326674' cy='12.88663858320467' r='3' fill='%230365a8'/%3e %3ccircle cx='232.45351546657' cy='50.449394029284804' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='66.45133269496905' cy='44.32183187886386' r='3' fill='%230365a8'/%3e %3ccircle cx='269.12945495688507' cy='69.3638333292221' r='3' fill='%230365a8'/%3e %3ccircle cx='31.854198522901843' cy='81.83511294832655' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='212.86894539596736' cy='105.45442404977764' r='3' fill='%23ff7f0e'/%3e %3ccircle cx='18.168699596801126' cy='30.804787060311547' r='3' fill='%230365a8'/%3e %3c/g%3e%3c/svg%3e",icon:"data:image/svg+xml,%3csvg id='rawgraphs-icons' xmlns='http://www.w3.org/2000/svg' width='56' height='56' viewBox='0 0 56 56'%3e %3cdefs%3e %3cstyle%3e .cls-1 %7b fill: %23df88ff%3b %7d .cls-2 %7b fill: %23ad00ff%3b %7d %3c/style%3e %3c/defs%3e %3cg id='secundary'%3e %3ccircle class='cls-1' cx='22.5' cy='39.5' r='3.5'/%3e %3ccircle class='cls-1' cx='17' cy='20' r='6'/%3e %3ccircle class='cls-1' cx='41.5' cy='37.5' r='2.5'/%3e %3c/g%3e %3cg id='primary'%3e %3cpolygon class='cls-2' points='46.305 46.805 44.865 46.805 46.061 48 8 48 8 9.939 9.195 11.135 9.195 9.695 7.5 8 5.805 9.695 5.805 11.135 7 9.939 7 49 46.061 49 44.865 50.195 46.305 50.195 48 48.5 46.305 46.805'/%3e %3ccircle class='cls-2' cx='31.5' cy='28.5' r='6.5'/%3e %3ccircle class='cls-2' cx='37.5' cy='15.5' r='3.5'/%3e %3c/g%3e%3c/svg%3e"};var n="http://www.w3.org/1999/xhtml",i={svg:"http://www.w3.org/2000/svg",xhtml:n,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function o(t){var e=t+="",r=e.indexOf(":");return r>=0&&"xmlns"!==(e=t.slice(0,r))&&(t=t.slice(r+1)),i.hasOwnProperty(e)?{space:i[e],local:t}:t}function s(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===n&&e.documentElement.namespaceURI===n?e.createElement(t):e.createElementNS(r,t)}}function a(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function l(t){var e=o(t);return(e.local?a:s)(e)}function c(){}function u(t){return null==t?c:function(){return this.querySelector(t)}}function h(){return[]}function f(t){return null==t?h:function(){return this.querySelectorAll(t)}}function g(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}function p(t){return function(){return this.matches(t)}}function m(t){return function(e){return e.matches(t)}}var d=Array.prototype.find;function y(){return this.firstElementChild}var w=Array.prototype.filter;function v(){return Array.from(this.children)}function b(t){return new Array(t.length)}function x(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function M(t,e,r,n,i,o){for(var s,a=0,l=e.length,c=o.length;a<c;++a)(s=e[a])?(s.__data__=o[a],n[a]=s):r[a]=new x(t,o[a]);for(;a<l;++a)(s=e[a])&&(i[a]=s)}function _(t,e,r,n,i,o,s){var a,l,c,u=new Map,h=e.length,f=o.length,g=new Array(h);for(a=0;a<h;++a)(l=e[a])&&(g[a]=c=s.call(l,l.__data__,a,e)+"",u.has(c)?i[a]=l:u.set(c,l));for(a=0;a<f;++a)c=s.call(t,o[a],a,o)+"",(l=u.get(c))?(n[a]=l,l.__data__=o[a],u.delete(c)):r[a]=new x(t,o[a]);for(a=0;a<h;++a)(l=e[a])&&u.get(g[a])===l&&(i[a]=l)}function S(t){return t.__data__}function k(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function E(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function N(t){return function(){this.removeAttribute(t)}}function A(t){return function(){this.removeAttributeNS(t.space,t.local)}}function R(t,e){return function(){this.setAttribute(t,e)}}function C(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function P(t,e){return function(){var r=e.apply(this,arguments);null==r?this.removeAttribute(t):this.setAttribute(t,r)}}function z(t,e){return function(){var r=e.apply(this,arguments);null==r?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function $(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function I(t){return function(){this.style.removeProperty(t)}}function T(t,e,r){return function(){this.style.setProperty(t,e,r)}}function F(t,e,r){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function j(t,e){return t.style.getPropertyValue(e)||$(t).getComputedStyle(t,null).getPropertyValue(e)}function O(t){return function(){delete this[t]}}function q(t,e){return function(){this[t]=e}}function V(t,e){return function(){var r=e.apply(this,arguments);null==r?delete this[t]:this[t]=r}}function D(t){return t.trim().split(/^|\s+/)}function L(t){return t.classList||new U(t)}function U(t){this._node=t,this._names=D(t.getAttribute("class")||"")}function H(t,e){for(var r=L(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function Y(t,e){for(var r=L(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function X(t){return function(){H(this,t)}}function B(t){return function(){Y(this,t)}}function W(t,e){return function(){(e.apply(this,arguments)?H:Y)(this,t)}}function G(){this.textContent=""}function K(t){return function(){this.textContent=t}}function Q(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Z(){this.innerHTML=""}function J(t){return function(){this.innerHTML=t}}function tt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function et(){this.nextSibling&&this.parentNode.appendChild(this)}function rt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function nt(){return null}function it(){var t=this.parentNode;t&&t.removeChild(this)}function ot(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function st(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function at(t){return function(){var e=this.__on;if(e){for(var r,n=0,i=-1,o=e.length;n<o;++n)r=e[n],t.type&&r.type!==t.type||r.name!==t.name?e[++i]=r:this.removeEventListener(r.type,r.listener,r.options);++i?e.length=i:delete this.__on}}}function lt(t,e,r){return function(){var n,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var s=0,a=i.length;s<a;++s)if((n=i[s]).type===t.type&&n.name===t.name)return this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=o,n.options=r),void(n.value=e);this.addEventListener(t.type,o,r),n={type:t.type,name:t.name,value:e,listener:o,options:r},i?i.push(n):this.__on=[n]}}function ct(t,e,r){var n=$(t),i=n.CustomEvent;"function"==typeof i?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ut(t,e){return function(){return ct(this,t,e)}}function ht(t,e){return function(){return ct(this,t,e.apply(this,arguments))}}x.prototype={constructor:x,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},U.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ft=[null];function gt(t,e){this._groups=t,this._parents=e}function pt(){return new gt([[document.documentElement]],ft)}function mt(t){return"string"==typeof t?new gt([[document.querySelector(t)]],[document.documentElement]):new gt([[t]],ft)}function dt(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function yt(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function wt(t){let e,r,n;function i(t,n,i=0,o=t.length){if(i<o){if(0!==e(n,n))return o;do{const e=i+o>>>1;r(t[e],n)<0?i=e+1:o=e}while(i<o)}return i}return 2!==t.length?(e=dt,r=(e,r)=>dt(t(e),r),n=(e,r)=>t(e)-r):(e=t===dt||t===yt?t:vt,r=t,n=t),{left:i,center:function(t,e,r=0,o=t.length){const s=i(t,e,r,o-1);return s>r&&n(t[s-1],e)>-n(t[s],e)?s-1:s},right:function(t,n,i=0,o=t.length){if(i<o){if(0!==e(n,n))return o;do{const e=i+o>>>1;r(t[e],n)<=0?i=e+1:o=e}while(i<o)}return i}}}function vt(){return 0}gt.prototype=pt.prototype={constructor:gt,select:function(t){"function"!=typeof t&&(t=u(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var o,s,a=e[i],l=a.length,c=n[i]=new Array(l),h=0;h<l;++h)(o=a[h])&&(s=t.call(o,o.__data__,h,a))&&("__data__"in o&&(s.__data__=o.__data__),c[h]=s);return new gt(n,this._parents)},selectAll:function(t){t="function"==typeof t?g(t):f(t);for(var e=this._groups,r=e.length,n=[],i=[],o=0;o<r;++o)for(var s,a=e[o],l=a.length,c=0;c<l;++c)(s=a[c])&&(n.push(t.call(s,s.__data__,c,a)),i.push(s));return new gt(n,i)},selectChild:function(t){return this.select(null==t?y:function(t){return function(){return d.call(this.children,t)}}("function"==typeof t?t:m(t)))},selectChildren:function(t){return this.selectAll(null==t?v:function(t){return function(){return w.call(this.children,t)}}("function"==typeof t?t:m(t)))},filter:function(t){"function"!=typeof t&&(t=p(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var o,s=e[i],a=s.length,l=n[i]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new gt(n,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,S);var r,n=e?_:M,i=this._parents,o=this._groups;"function"!=typeof t&&(r=t,t=function(){return r});for(var s=o.length,a=new Array(s),l=new Array(s),c=new Array(s),u=0;u<s;++u){var h=i[u],f=o[u],g=f.length,p=k(t.call(h,h&&h.__data__,u,i)),m=p.length,d=l[u]=new Array(m),y=a[u]=new Array(m);n(h,f,d,y,c[u]=new Array(g),p,e);for(var w,v,b=0,x=0;b<m;++b)if(w=d[b]){for(b>=x&&(x=b+1);!(v=y[x])&&++x<m;);w._next=v||null}}return(a=new gt(a,i))._enter=l,a._exit=c,a},enter:function(){return new gt(this._enter||this._groups.map(b),this._parents)},exit:function(){return new gt(this._exit||this._groups.map(b),this._parents)},join:function(t,e,r){var n=this.enter(),i=this,o=this.exit();return"function"==typeof t?(n=t(n))&&(n=n.selection()):n=n.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==r?o.remove():r(o),n&&i?n.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,i=r.length,o=n.length,s=Math.min(i,o),a=new Array(i),l=0;l<s;++l)for(var c,u=r[l],h=n[l],f=u.length,g=a[l]=new Array(f),p=0;p<f;++p)(c=u[p]||h[p])&&(g[p]=c);for(;l<i;++l)a[l]=r[l];return new gt(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n,i=t[e],o=i.length-1,s=i[o];--o>=0;)(n=i[o])&&(s&&4^n.compareDocumentPosition(s)&&s.parentNode.insertBefore(n,s),s=n);return this},sort:function(t){function e(e,r){return e&&r?t(e.__data__,r.__data__):!e-!r}t||(t=E);for(var r=this._groups,n=r.length,i=new Array(n),o=0;o<n;++o){for(var s,a=r[o],l=a.length,c=i[o]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(e)}return new gt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,o=n.length;i<o;++i){var s=n[i];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i,o=e[r],s=0,a=o.length;s<a;++s)(i=o[s])&&t.call(i,i.__data__,s,o);return this},attr:function(t,e){var r=o(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((null==e?r.local?A:N:"function"==typeof e?r.local?z:P:r.local?C:R)(r,e))},style:function(t,e,r){return arguments.length>1?this.each((null==e?I:"function"==typeof e?F:T)(t,e,null==r?"":r)):j(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?O:"function"==typeof e?V:q)(t,e)):this.node()[t]},classed:function(t,e){var r=D(t+"");if(arguments.length<2){for(var n=L(this.node()),i=-1,o=r.length;++i<o;)if(!n.contains(r[i]))return!1;return!0}return this.each(("function"==typeof e?W:e?X:B)(r,e))},text:function(t){return arguments.length?this.each(null==t?G:("function"==typeof t?Q:K)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Z:("function"==typeof t?tt:J)(t)):this.node().innerHTML},raise:function(){return this.each(et)},lower:function(){return this.each(rt)},append:function(t){var e="function"==typeof t?t:l(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var r="function"==typeof t?t:l(t),n=null==e?nt:"function"==typeof e?e:u(e);return this.select((function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)}))},remove:function(){return this.each(it)},clone:function(t){return this.select(t?st:ot)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,r){var n,i,o=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");return r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),{type:t,name:e}}))}(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?lt:at,n=0;n<s;++n)this.each(a(o[n],e,r));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(n=0,l=a[c];n<s;++n)if((i=o[n]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?ht:ut)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n,i=t[e],o=0,s=i.length;o<s;++o)(n=i[o])&&(yield n)}};const bt=wt(dt).right;wt((function(t){return null===t?NaN:+t})).center;var xt=bt;function Mt(t,e){let r,n;if(void 0===e)for(const e of t)null!=e&&(void 0===r?e>=e&&(r=n=e):(r>e&&(r=e),n<e&&(n=e)));else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(void 0===r?o>=o&&(r=n=o):(r>o&&(r=o),n<o&&(n=o)))}return[r,n]}const _t=Math.sqrt(50),St=Math.sqrt(10),kt=Math.sqrt(2);function Et(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),o=n/Math.pow(10,i),s=o>=_t?10:o>=St?5:o>=kt?2:1;let a,l,c;return i<0?(c=Math.pow(10,-i)/s,a=Math.round(t*c),l=Math.round(e*c),a/c<t&&++a,l/c>e&&--l,c=-c):(c=Math.pow(10,i)*s,a=Math.round(t/c),l=Math.round(e/c),a*c<t&&++a,l*c>e&&--l),l<a&&.5<=r&&r<2?Et(t,e,2*r):[a,l,c]}function Nt(t,e,r){return Et(t=+t,e=+e,r=+r)[2]}function At(t){return t}var Rt=1e-6;function Ct(t){return"translate("+t+",0)"}function Pt(t){return"translate(0,"+t+")"}function zt(t){return e=>+t(e)}function $t(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),r=>+t(r)+e}function It(){return!this.__axis}function Tt(t,e){var r=[],n=null,i=null,o=6,s=6,a=3,l="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,c=1===t||4===t?-1:1,u=4===t||2===t?"x":"y",h=1===t||3===t?Ct:Pt;function f(f){var g=null==n?e.ticks?e.ticks.apply(e,r):e.domain():n,p=null==i?e.tickFormat?e.tickFormat.apply(e,r):At:i,m=Math.max(o,0)+a,d=e.range(),y=+d[0]+l,w=+d[d.length-1]+l,v=(e.bandwidth?$t:zt)(e.copy(),l),b=f.selection?f.selection():f,x=b.selectAll(".domain").data([null]),M=b.selectAll(".tick").data(g,e).order(),_=M.exit(),S=M.enter().append("g").attr("class","tick"),k=M.select("line"),E=M.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),M=M.merge(S),k=k.merge(S.append("line").attr("stroke","currentColor").attr(u+"2",c*o)),E=E.merge(S.append("text").attr("fill","currentColor").attr(u,c*m).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),f!==b&&(x=x.transition(f),M=M.transition(f),k=k.transition(f),E=E.transition(f),_=_.transition(f).attr("opacity",Rt).attr("transform",(function(t){return isFinite(t=v(t))?h(t+l):this.getAttribute("transform")})),S.attr("opacity",Rt).attr("transform",(function(t){var e=this.parentNode.__axis;return h((e&&isFinite(e=e(t))?e:v(t))+l)}))),_.remove(),x.attr("d",4===t||2===t?s?"M"+c*s+","+y+"H"+l+"V"+w+"H"+c*s:"M"+l+","+y+"V"+w:s?"M"+y+","+c*s+"V"+l+"H"+w+"V"+c*s:"M"+y+","+l+"H"+w),M.attr("opacity",1).attr("transform",(function(t){return h(v(t)+l)})),k.attr(u+"2",c*o),E.attr(u,c*m).text(p),b.filter(It).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),b.each((function(){this.__axis=v}))}return f.scale=function(t){return arguments.length?(e=t,f):e},f.ticks=function(){return r=Array.from(arguments),f},f.tickArguments=function(t){return arguments.length?(r=null==t?[]:Array.from(t),f):r.slice()},f.tickValues=function(t){return arguments.length?(n=null==t?null:Array.from(t),f):n&&n.slice()},f.tickFormat=function(t){return arguments.length?(i=t,f):i},f.tickSize=function(t){return arguments.length?(o=s=+t,f):o},f.tickSizeInner=function(t){return arguments.length?(o=+t,f):o},f.tickSizeOuter=function(t){return arguments.length?(s=+t,f):s},f.tickPadding=function(t){return arguments.length?(a=+t,f):a},f.offset=function(t){return arguments.length?(l=+t,f):l},f}function Ft(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function jt(t){return(t=Ft(Math.abs(t)))?t[1]:NaN}var Ot,qt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Vt(t){if(!(e=qt.exec(t)))throw new Error("invalid format: "+t);var e;return new Dt({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Dt(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Lt(t,e){var r=Ft(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}Vt.prototype=Dt.prototype,Dt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Ut={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Lt(100*t,e),r:Lt,s:function(t,e){var r=Ft(t,e);if(!r)return t+"";var n=r[0],i=r[1],o=i-(Ot=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=n.length;return o===s?n:o>s?n+new Array(o-s+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+Ft(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ht(t){return t}var Yt,Xt,Bt,Wt=Array.prototype.map,Gt=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Kt(t){var e,r,n=void 0===t.grouping||void 0===t.thousands?Ht:(e=Wt.call(t.grouping,Number),r=t.thousands+"",function(t,n){for(var i=t.length,o=[],s=0,a=e[0],l=0;i>0&&a>0&&(l+a+1>n&&(a=Math.max(1,n-l)),o.push(t.substring(i-=a,i+a)),!((l+=a+1)>n));)a=e[s=(s+1)%e.length];return o.reverse().join(r)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?Ht:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Wt.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"−":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=Vt(t)).fill,r=t.align,h=t.sign,f=t.symbol,g=t.zero,p=t.width,m=t.comma,d=t.precision,y=t.trim,w=t.type;"n"===w?(m=!0,w="g"):Ut[w]||(void 0===d&&(d=12),y=!0,w="g"),(g||"0"===e&&"="===r)&&(g=!0,e="0",r="=");var v="$"===f?i:"#"===f&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",b="$"===f?o:/[%p]/.test(w)?l:"",x=Ut[w],M=/[defgprs%]/.test(w);function _(t){var i,o,l,f=v,_=b;if("c"===w)_=x(t)+_,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:x(Math.abs(t),d),y&&(t=function(t){t:for(var e,r=t.length,n=1,i=-1;n<r;++n)switch(t[n]){case".":i=e=n;break;case"0":0===i&&(i=n),e=n;break;default:if(!+t[n])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),S&&0===+t&&"+"!==h&&(S=!1),f=(S?"("===h?h:c:"-"===h||"("===h?"":h)+f,_=("s"===w?Gt[8+Ot/3]:"")+_+(S&&"("===h?")":""),M)for(i=-1,o=t.length;++i<o;)if(48>(l=t.charCodeAt(i))||l>57){_=(46===l?s+t.slice(i+1):t.slice(i))+_,t=t.slice(0,i);break}}m&&!g&&(t=n(t,1/0));var k=f.length+t.length+_.length,E=k<p?new Array(p-k+1).join(e):"";switch(m&&g&&(t=n(E+t,E.length?p-_.length:1/0),E=""),r){case"<":t=f+t+_+E;break;case"=":t=f+E+t+_;break;case"^":t=E.slice(0,k=E.length>>1)+f+t+_+E.slice(k);break;default:t=E+f+t+_}return a(t)}return d=void 0===d?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),_.toString=function(){return t+""},_}return{format:h,formatPrefix:function(t,e){var r=h(((t=Vt(t)).type="f",t)),n=3*Math.max(-8,Math.min(8,Math.floor(jt(e)/3))),i=Math.pow(10,-n),o=Gt[8+n/3];return function(t){return r(i*t)+o}}}}function Qt(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Zt(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function Jt(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function te(){}Yt=Kt({thousands:",",grouping:[3],currency:["$",""]}),Xt=Yt.format,Bt=Yt.formatPrefix;var ee=.7,re=1/ee,ne="\\s*([+-]?\\d+)\\s*",ie="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",oe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",se=/^#([0-9a-f]{3,8})$/,ae=new RegExp(`^rgb\\(${ne},${ne},${ne}\\)$`),le=new RegExp(`^rgb\\(${oe},${oe},${oe}\\)$`),ce=new RegExp(`^rgba\\(${ne},${ne},${ne},${ie}\\)$`),ue=new RegExp(`^rgba\\(${oe},${oe},${oe},${ie}\\)$`),he=new RegExp(`^hsl\\(${ie},${oe},${oe}\\)$`),fe=new RegExp(`^hsla\\(${ie},${oe},${oe},${ie}\\)$`),ge={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function pe(){return this.rgb().formatHex()}function me(){return this.rgb().formatRgb()}function de(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=se.exec(t))?(r=e[1].length,e=parseInt(e[1],16),6===r?ye(e):3===r?new be(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===r?we(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===r?we(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=ae.exec(t))?new be(e[1],e[2],e[3],1):(e=le.exec(t))?new be(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=ce.exec(t))?we(e[1],e[2],e[3],e[4]):(e=ue.exec(t))?we(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=he.exec(t))?Ee(e[1],e[2]/100,e[3]/100,1):(e=fe.exec(t))?Ee(e[1],e[2]/100,e[3]/100,e[4]):ge.hasOwnProperty(t)?ye(ge[t]):"transparent"===t?new be(NaN,NaN,NaN,0):null}function ye(t){return new be(t>>16&255,t>>8&255,255&t,1)}function we(t,e,r,n){return n<=0&&(t=e=r=NaN),new be(t,e,r,n)}function ve(t,e,r,n){return 1===arguments.length?((i=t)instanceof te||(i=de(i)),i?new be((i=i.rgb()).r,i.g,i.b,i.opacity):new be):new be(t,e,r,null==n?1:n);var i}function be(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}function xe(){return`#${ke(this.r)}${ke(this.g)}${ke(this.b)}`}function Me(){const t=_e(this.opacity);return`${1===t?"rgb(":"rgba("}${Se(this.r)}, ${Se(this.g)}, ${Se(this.b)}${1===t?")":`, ${t})`}`}function _e(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Se(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ke(t){return((t=Se(t))<16?"0":"")+t.toString(16)}function Ee(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Ae(t,e,r,n)}function Ne(t){if(t instanceof Ae)return new Ae(t.h,t.s,t.l,t.opacity);if(t instanceof te||(t=de(t)),!t)return new Ae;if(t instanceof Ae)return t;var e=(t=t.rgb()).r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),o=Math.max(e,r,n),s=NaN,a=o-i,l=(o+i)/2;return a?(s=e===o?(r-n)/a+6*(r<n):r===o?(n-e)/a+2:(e-r)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new Ae(s,a,l,t.opacity)}function Ae(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}function Re(t){return(t=(t||0)%360)<0?t+360:t}function Ce(t){return Math.max(0,Math.min(1,t||0))}function Pe(t,e,r){return 255*(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)}Zt(te,de,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:pe,formatHex:pe,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Ne(this).formatHsl()},formatRgb:me,toString:me}),Zt(be,ve,Jt(te,{brighter(t){return t=null==t?re:Math.pow(re,t),new be(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?ee:Math.pow(ee,t),new be(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new be(Se(this.r),Se(this.g),Se(this.b),_e(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xe,formatHex:xe,formatHex8:function(){return`#${ke(this.r)}${ke(this.g)}${ke(this.b)}${ke(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Me,toString:Me})),Zt(Ae,(function(t,e,r,n){return 1===arguments.length?Ne(t):new Ae(t,e,r,null==n?1:n)}),Jt(te,{brighter(t){return t=null==t?re:Math.pow(re,t),new Ae(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?ee:Math.pow(ee,t),new Ae(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new be(Pe(t>=240?t-240:t+120,i,n),Pe(t,i,n),Pe(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new Ae(Re(this.h),Ce(this.s),Ce(this.l),_e(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=_e(this.opacity);return`${1===t?"hsl(":"hsla("}${Re(this.h)}, ${100*Ce(this.s)}%, ${100*Ce(this.l)}%${1===t?")":`, ${t})`}`}}));var ze=t=>()=>t;function $e(t){return 1===(t=+t)?Ie:function(e,r){return r-e?function(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}(e,r,t):ze(isNaN(e)?r:e)}}function Ie(t,e){var r=e-t;return r?function(t,e){return function(r){return t+r*e}}(t,r):ze(isNaN(t)?e:t)}var Te=function t(e){var r=$e(e);function n(t,e){var n=r((t=ve(t)).r,(e=ve(e)).r),i=r(t.g,e.g),o=r(t.b,e.b),s=Ie(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=i(e),t.b=o(e),t.opacity=s(e),t+""}}return n.gamma=t,n}(1);function Fe(t,e){e||(e=[]);var r,n=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(r=0;r<n;++r)i[r]=t[r]*(1-o)+e[r]*o;return i}}function je(t,e){var r,n=e?e.length:0,i=t?Math.min(n,t.length):0,o=new Array(i),s=new Array(n);for(r=0;r<i;++r)o[r]=He(t[r],e[r]);for(;r<n;++r)s[r]=e[r];return function(t){for(r=0;r<i;++r)s[r]=o[r](t);return s}}function Oe(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function qe(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function Ve(t,e){var r,n={},i={};for(r in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)r in t?n[r]=He(t[r],e[r]):i[r]=e[r];return function(t){for(r in n)i[r]=n[r](t);return i}}var De=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Le=new RegExp(De.source,"g");function Ue(t,e){var r,n,i,o=De.lastIndex=Le.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(r=De.exec(t))&&(n=Le.exec(e));)(i=n.index)>o&&(i=e.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(n=n[0])?a[s]?a[s]+=n:a[++s]=n:(a[++s]=null,l.push({i:s,x:qe(r,n)})),o=Le.lastIndex;return o<e.length&&(i=e.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var r,n=0;n<e;++n)a[(r=l[n]).i]=r.x(t);return a.join("")})}function He(t,e){var r,n,i=typeof e;return null==e||"boolean"===i?ze(e):("number"===i?qe:"string"===i?(r=de(e))?(e=r,Te):Ue:e instanceof de?Te:e instanceof Date?Oe:(n=e,!ArrayBuffer.isView(n)||n instanceof DataView?Array.isArray(e)?je:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Ve:qe:Fe))(t,e)}function Ye(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function Xe(t){return+t}var Be=[0,1];function We(t){return t}function Ge(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:(r=isNaN(e)?NaN:.5,function(){return r});var r}function Ke(t,e,r){var n=t[0],i=t[1],o=e[0],s=e[1];return i<n?(n=Ge(i,n),o=r(s,o)):(n=Ge(n,i),o=r(o,s)),function(t){return o(n(t))}}function Qe(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),o=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)i[s]=Ge(t[s],t[s+1]),o[s]=r(e[s],e[s+1]);return function(e){var r=xt(t,e,1,n)-1;return o[r](i[r](e))}}function Ze(){var t,e,r,n,i,o,s=Be,a=Be,l=He,c=We;function u(){var t,e,r,l=Math.min(s.length,a.length);return c!==We&&(t=s[0],e=s[l-1],t>e&&(r=t,t=e,e=r),c=function(r){return Math.max(t,Math.min(e,r))}),n=l>2?Qe:Ke,i=o=null,h}function h(e){return null==e||isNaN(e=+e)?r:(i||(i=n(s.map(t),a,l)))(t(c(e)))}return h.invert=function(r){return c(e((o||(o=n(a,s.map(t),qe)))(r)))},h.domain=function(t){return arguments.length?(s=Array.from(t,Xe),u()):s.slice()},h.range=function(t){return arguments.length?(a=Array.from(t),u()):a.slice()},h.rangeRound=function(t){return a=Array.from(t),l=Ye,u()},h.clamp=function(t){return arguments.length?(c=!!t||We,u()):c!==We},h.interpolate=function(t){return arguments.length?(l=t,u()):l},h.unknown=function(t){return arguments.length?(r=t,h):r},function(r,n){return t=r,e=n,u()}}function Je(t,e,r,n){var i,o=function(t,e,r){r=+r;const n=(e=+e)<(t=+t),i=n?Nt(e,t,r):Nt(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}(t,e,r);switch((n=Vt(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=n.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(jt(e)/3)))-jt(Math.abs(t)))}(o,s))||(n.precision=i),Bt(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,jt(e)-jt(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(n.precision=i-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(i=function(t){return Math.max(0,-jt(Math.abs(t)))}(o))||(n.precision=i-2*("%"===n.type))}return Xt(n)}function tr(t){var e=t.domain;return t.ticks=function(t){var r=e();return function(t,e,r){if(!((r=+r)>0))return[];if((t=+t)===(e=+e))return[t];const n=e<t,[i,o,s]=n?Et(e,t,r):Et(t,e,r);if(!(o>=i))return[];const a=o-i+1,l=new Array(a);if(n)if(s<0)for(let t=0;t<a;++t)l[t]=(o-t)/-s;else for(let t=0;t<a;++t)l[t]=(o-t)*s;else if(s<0)for(let t=0;t<a;++t)l[t]=(i+t)/-s;else for(let t=0;t<a;++t)l[t]=(i+t)*s;return l}(r[0],r[r.length-1],null==t?10:t)},t.tickFormat=function(t,r){var n=e();return Je(n[0],n[n.length-1],null==t?10:t,r)},t.nice=function(r){null==r&&(r=10);var n,i,o=e(),s=0,a=o.length-1,l=o[s],c=o[a],u=10;for(c<l&&(i=l,l=c,c=i,i=s,s=a,a=i);u-- >0;){if((i=Nt(l,c,r))===n)return o[s]=l,o[a]=c,e(o);if(i>0)l=Math.floor(l/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,c=Math.floor(c*i)/i}n=i}return t},t}function er(){var t=Ze()(We,We);return t.copy=function(){return e=t,er().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},Qt.apply(t,arguments),tr(t)}function rr(t){var e=function(t,e){if(!t)throw e||"Assertion failed"},r=function(t,e,r){return t.hasOwnProperty(e)?t[e]:r},n=!1,i=0,o=function(){if(n)return n=!1,i;var t=2*Math.random()-1,e=2*Math.random()-1,r=t*t+e*e;if(0==r||r>1)return o();var s=Math.sqrt(-2*Math.log(r)/r);return i=e*s,n=!0,t*s},s=function(t){if(void 0===t||isNaN(t))return[];if("undefined"==typeof ArrayBuffer){for(var e=new Array(t),r=0;r<t;r++)e[r]=0;return e}return new Float64Array(t)},a=function(t,e,r){for(var n,i=void 0!==r,s=[],a=0;a<t;a++){for(var l=[],c=0;c<e;c++)i?l.push(r):l.push((n=1e-4,0+o()*n));s.push(l)}return s},l=function(t,e){for(var r=t.length,n=0,i=0;i<r;i++){var o=t[i],s=e[i];n+=(o-s)*(o-s)}return n},c=function(t,r,n){var i=Math.sqrt(t.length),o=Math.floor(i);e(o===i,"D should have square number of elements.");for(var a=Math.log(r),l=s(o*o),c=s(o),u=0;u<o;u++){for(var h=-1/0,f=1/0,g=1,p=!1,m=0;!p;){for(var d=0,y=0;y<o;y++){var w=Math.exp(-t[u*o+y]*g);u===y&&(w=0),c[y]=w,d+=w}var v=0;for(y=0;y<o;y++){if(0==d)w=0;else w=c[y]/d;c[y]=w,w>1e-7&&(v-=w*Math.log(w))}v>a?(h=g,f===1/0?g*=2:g=(g+f)/2):(f=g,h===-1/0?g/=2:g=(g+h)/2),m++,Math.abs(v-a)<n&&(p=!0),m>=50&&(p=!0)}for(y=0;y<o;y++)l[u*o+y]=c[y]}var b=s(o*o),x=2*o;for(u=0;u<o;u++)for(y=0;y<o;y++)b[u*o+y]=Math.max((l[u*o+y]+l[y*o+u])/x,1e-100);return b};function u(t){return t>0?1:t<0?-1:0}var h=function(t){t=t||{};this.perplexity=r(t,"perplexity",30),this.dim=r(t,"dim",2),this.epsilon=r(t,"epsilon",10),this.iter=0};return h.prototype={initDataRaw:function(t){var r=t.length,n=t[0].length;e(r>0," X is empty? You must have some data!"),e(n>0," X[0] is empty? Where is the data?");var i=function(t){for(var e=t.length,r=s(e*e),n=0;n<e;n++)for(var i=n+1;i<e;i++){var o=l(t[n],t[i]);r[n*e+i]=o,r[i*e+n]=o}return r}(t);this.P=c(i,this.perplexity,1e-4),this.N=r,this.initSolution()},initDataDist:function(t){var r=t.length;e(r>0," X is empty? You must have some data!");for(var n=s(r*r),i=0;i<r;i++)for(var o=i+1;o<r;o++){var a=t[i][o];n[i*r+o]=a,n[o*r+i]=a}this.P=c(n,this.perplexity,1e-4),this.N=r,this.initSolution()},initSolution:function(){this.Y=a(this.N,this.dim),this.gains=a(this.N,this.dim,1),this.ystep=a(this.N,this.dim,0),this.iter=0},getSolution:function(){return this.Y},step:function(){this.iter+=1;for(var t=this.N,e=this.costGrad(this.Y),r=e.cost,n=e.grad,i=s(this.dim),o=0;o<t;o++)for(var a=0;a<this.dim;a++){var l=n[o][a],c=this.ystep[o][a],h=this.gains[o][a],f=u(l)===u(c)?.8*h:h+.2;f<.01&&(f=.01),this.gains[o][a]=f;var g=(this.iter<250?.5:.8)*c-this.epsilon*f*n[o][a];this.ystep[o][a]=g,this.Y[o][a]+=g,i[a]+=this.Y[o][a]}for(o=0;o<t;o++)for(a=0;a<this.dim;a++)this.Y[o][a]-=i[a]/t;return r},debugGrad:function(){var t=this.N,e=this.costGrad(this.Y);e.cost;for(var r=e.grad,n=1e-5,i=0;i<t;i++)for(var o=0;o<this.dim;o++){var s=this.Y[i][o];this.Y[i][o]=s+n;var a=this.costGrad(this.Y);this.Y[i][o]=s-n;var l=this.costGrad(this.Y),c=r[i][o],u=(a.cost-l.cost)/(2*n);console.log(i+","+o+": gradcheck analytic: "+c+" vs. numerical: "+u),this.Y[i][o]=s}},costGrad:function(t){for(var e=this.N,r=this.dim,n=this.P,i=this.iter<100?4:1,o=s(e*e),a=0,l=0;l<e;l++)for(var c=l+1;c<e;c++){for(var u=0,h=0;h<r;h++){var f=t[l][h]-t[c][h];u+=f*f}var g=1/(1+u);o[l*e+c]=g,o[c*e+l]=g,a+=2*g}for(var p=e*e,m=s(p),d=0;d<p;d++)m[d]=Math.max(o[d]/a,1e-100);var y=0,w=[];for(l=0;l<e;l++){var v=new Array(r);for(h=0;h<r;h++)v[h]=0;for(c=0;c<e;c++){y+=-n[l*e+c]*Math.log(m[l*e+c]);var b=4*(i*n[l*e+c]-m[l*e+c])*o[l*e+c];for(h=0;h<r;h++)v[h]+=b*(t[l][h]-t[c][h])}w.push(v)}return{cost:y,grad:w}}},new h(t)}const nr=Object.prototype.toString;function ir(t){const e=nr.call(t);return e.endsWith("Array]")&&!e.includes("Big")}function or(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ir(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!ir(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ir(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,o=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[n],a=n+1;a<o;a++)t[a]<s&&(s=t[a]);return s}(t),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ir(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,o=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[n],a=n+1;a<o;a++)t[a]>s&&(s=t[a]);return s}(t);if(n===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=r.min,s=void 0===o?r.autoMinMax?n:0:o,a=r.max,l=void 0===a?r.autoMinMax?i:1:a;if(s>=l)throw new RangeError("min option must be smaller than max option");for(var c=(l-s)/(i-n),u=0;u<t.length;u++)e[u]=(t[u]-n)*c+s;return e}const sr=" ".repeat(2),ar=" ".repeat(4);function lr(t,e={}){const{maxRows:r=15,maxColumns:n=10,maxNumSize:i=8,padMinus:o="auto"}=e;return`${t.constructor.name} {\n${sr}[\n${ar}${function(t,e,r,n,i){const{rows:o,columns:s}=t,a=Math.min(o,e),l=Math.min(s,r),c=[];if("auto"===i){i=!1;t:for(let e=0;e<a;e++)for(let r=0;r<l;r++)if(t.get(e,r)<0){i=!0;break t}}for(let e=0;e<a;e++){let r=[];for(let o=0;o<l;o++)r.push(cr(t.get(e,o),n,i));c.push(`${r.join(" ")}`)}l!==s&&(c[c.length-1]+=` ... ${s-r} more columns`);a!==o&&c.push(`... ${o-e} more rows`);return c.join(`\n${ar}`)}(t,r,n,i,o)}\n${sr}]\n${sr}rows: ${t.rows}\n${sr}columns: ${t.columns}\n}`}function cr(t,e,r){return(t>=0&&r?` ${ur(t,e-1)}`:ur(t,e)).padEnd(e)}function ur(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let i=t.toExponential(e);return i.length>e&&(i=t.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function hr(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function fr(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function gr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function pr(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function mr(t,e,r,n,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(yr("startRow",e),yr("endRow",r),yr("startColumn",n),yr("endColumn",i),e>r||n>i||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function dr(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function yr(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function wr(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class vr{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new Mr(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)n.set(i,t,r[i*e+t]);return n}static rowVector(t){let e=new Mr(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new Mr(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new Mr(t,e)}static ones(t,e){return new Mr(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let i=new Mr(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)i.set(r,t,n());return i}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:i=1e3,random:o=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(i))throw new TypeError("max must be an integer");if(n>=i)throw new RangeError("min must be smaller than max");let s=i-n,a=new Mr(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(o()*s);a.set(r,t,e)}return a}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),i=this.zeros(t,e);for(let t=0;t<n;t++)i.set(t,t,r);return i}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let i=Math.min(n,e,r),o=this.zeros(e,r);for(let e=0;e<i;e++)o.set(e,e,t[e]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new Mr(r,n);for(let o=0;o<r;o++)for(let r=0;r<n;r++)i.set(o,r,Math.min(t.get(o,r),e.get(o,r)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new this(r,n);for(let o=0;o<r;o++)for(let r=0;r<n;r++)i.set(o,r,Math.max(t.get(o,r),e.get(o,r)));return i}static checkMatrix(t){return vr.isMatrix(t)?t:new Mr(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let i=e;i<t.rows;i++)t.get(i,r)>t.get(n,r)&&(n=i);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let i=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/i);for(let n=e+1;n<t.rows;n++){let i=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let o=r+1;o<t.columns;o++)t.set(n,o,t.get(n,o)-t.get(e,o)*i)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let i=0,o=!1;for(;i<r&&!1===o;)1===t.get(n,i)?o=!0:i++;for(let r=0;r<n;r++){let o=t.get(r,i);for(let s=i;s<e;s++){let e=t.get(r,s)-o*t.get(n,s);t.set(r,s,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new Mr(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){hr(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return Mr.rowVector(this.getRow(t))}setRow(t,e){hr(this,t),e=gr(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){hr(this,t),hr(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){fr(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return Mr.columnVector(this.getColumn(t))}setColumn(t,e){fr(this,t),e=pr(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){fr(this,t),fr(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=gr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=gr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=gr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=gr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=pr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=pr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=pr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=pr(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){hr(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){fr(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){wr(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){wr(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(hr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){hr(this,t),wr(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(hr(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){hr(this,t),wr(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(fr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){fr(this,t),wr(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(fr(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){fr(this,t),wr(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){vr.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=Mr.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,i=new Mr(e,n),o=new Float64Array(r);for(let s=0;s<n;s++){for(let e=0;e<r;e++)o[e]=t.get(e,s);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*o[n];i.set(t,s,e)}}return i}mpow(t){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw new RangeError("Exponent must be a non-negative integer");let e=Mr.eye(this.rows),r=this;for(let n=t;n>=1;n/=2)1&n&&(e=e.mmul(r)),r=r.mmul(r);return e}strassen2x2(t){t=Mr.checkMatrix(t);let e=new Mr(2,2);const r=this.get(0,0),n=t.get(0,0),i=this.get(0,1),o=t.get(0,1),s=this.get(1,0),a=t.get(1,0),l=this.get(1,1),c=t.get(1,1),u=(r+l)*(n+c),h=(s+l)*n,f=r*(o-c),g=l*(a-n),p=(r+i)*c,m=u+g-p+(i-l)*(a+c),d=f+p,y=h+g,w=u-h+f+(s-r)*(n+o);return e.set(0,0,m),e.set(0,1,d),e.set(1,0,y),e.set(1,1,w),e}strassen3x3(t){t=Mr.checkMatrix(t);let e=new Mr(3,3);const r=this.get(0,0),n=this.get(0,1),i=this.get(0,2),o=this.get(1,0),s=this.get(1,1),a=this.get(1,2),l=this.get(2,0),c=this.get(2,1),u=this.get(2,2),h=t.get(0,0),f=t.get(0,1),g=t.get(0,2),p=t.get(1,0),m=t.get(1,1),d=t.get(1,2),y=t.get(2,0),w=t.get(2,1),v=t.get(2,2),b=(r-o)*(-f+m),x=(-r+o+s)*(h-f+m),M=(o+s)*(-h+f),_=r*h,S=(-r+l+c)*(h-g+d),k=(-r+l)*(g-d),E=(l+c)*(-h+g),N=(-i+c+u)*(m+y-w),A=(i-u)*(m-w),R=i*y,C=(c+u)*(-y+w),P=(-i+s+a)*(d+y-v),z=(i-a)*(d-v),$=(s+a)*(-y+v),I=_+R+n*p,T=(r+n+i-o-s-c-u)*m+x+M+_+N+R+C,F=_+S+E+(r+n+i-s-a-l-c)*d+R+P+$,j=b+s*(-h+f+p-m-d-y+v)+x+_+R+P+z,O=b+x+M+_+a*w,q=R+P+z+$+o*g,V=_+S+k+c*(-h+g+p-m-d-y+w)+N+A+R,D=N+A+R+C+l*f,L=_+S+k+E+u*v;return e.set(0,0,I),e.set(0,1,T),e.set(0,2,F),e.set(1,0,j),e.set(1,1,O),e.set(1,2,q),e.set(2,0,V),e.set(2,1,D),e.set(2,2,L),e}mmulStrassen(t){t=Mr.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,i=t.rows,o=t.columns;function s(t,e,r){let n=t.rows,i=t.columns;if(n===e&&i===r)return t;{let n=vr.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==i&&console.warn(`Multiplying ${r} x ${n} and ${i} x ${o} matrix: dimensions do not match.`);let a=Math.max(r,i),l=Math.max(n,o);return e=s(e,a,l),function t(e,r,n,i){if(n<=512||i<=512)return e.mmul(r);n%2==1&&i%2==1?(e=s(e,n+1,i+1),r=s(r,n+1,i+1)):n%2==1?(e=s(e,n+1,i),r=s(r,n+1,i)):i%2==1&&(e=s(e,n,i+1),r=s(r,n,i+1));let o=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),l=e.subMatrix(0,o-1,0,a-1),c=r.subMatrix(0,o-1,0,a-1),u=e.subMatrix(0,o-1,a,e.columns-1),h=r.subMatrix(0,o-1,a,r.columns-1),f=e.subMatrix(o,e.rows-1,0,a-1),g=r.subMatrix(o,r.rows-1,0,a-1),p=e.subMatrix(o,e.rows-1,a,e.columns-1),m=r.subMatrix(o,r.rows-1,a,r.columns-1),d=t(vr.add(l,p),vr.add(c,m),o,a),y=t(vr.add(f,p),c,o,a),w=t(l,vr.sub(h,m),o,a),v=t(p,vr.sub(g,c),o,a),b=t(vr.add(l,u),m,o,a),x=t(vr.sub(f,l),vr.add(c,h),o,a),M=t(vr.sub(u,p),vr.add(g,m),o,a),_=vr.add(d,v);_.sub(b),_.add(M);let S=vr.add(w,b),k=vr.add(y,v),E=vr.sub(d,y);E.add(w),E.add(x);let N=vr.zeros(2*_.rows,2*_.columns);return N=N.setSubMatrix(_,0,0),N=N.setSubMatrix(S,_.rows,0),N=N.setSubMatrix(k,0,_.columns),N=N.setSubMatrix(E,_.rows,_.columns),N.subMatrix(0,n-1,0,i-1)}(e,t=s(t,a,l),a,l)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new Mr(this.rows,this.columns);for(let t=0;t<this.rows;t++){const i=this.getRow(t);i.length>0&&or(i,{min:e,max:r,output:i}),n.setRow(t,i)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let n=new Mr(this.rows,this.columns);for(let t=0;t<this.columns;t++){const i=this.getColumn(t);i.length&&or(i,{min:e,max:r,output:i}),n.setColumn(t,i)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=Mr.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,i=t.columns,o=new Mr(e*n,r*i);for(let s=0;s<e;s++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let a=0;a<i;a++)o.set(n*s+r,i*e+a,this.get(s,e)*t.get(r,a));return o}kroneckerSum(t){if(t=Mr.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(Mr.eye(r,r)),i=Mr.eye(e,e).kroneckerProduct(t);return n.add(i)}transpose(){let t=new Mr(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=br){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=br){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){mr(this,t,e,r,n);let i=new Mr(e-t+1,n-r+1);for(let o=t;o<=e;o++)for(let e=r;e<=n;e++)i.set(o-t,e-r,this.get(o,e));return i}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new Mr(t.length,r-e+1);for(let i=0;i<t.length;i++)for(let o=e;o<=r;o++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);n.set(i,o-e,this.get(t[i],o))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new Mr(r-e+1,t.length);for(let i=0;i<t.length;i++)for(let o=e;o<=r;o++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);n.set(o-e,i,this.get(o,t[i]))}return n}setSubMatrix(t,e,r){if((t=Mr.checkMatrix(t)).isEmpty())return this;mr(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)this.set(e+n,r+i,t.get(n,i));return this}selection(t,e){!function(t,e){if(!ir(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}(this,t),function(t,e){if(!ir(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}(this,e);let r=new Mr(t.length,e.length);for(let n=0;n<t.length;n++){let i=t[n];for(let t=0;t<e.length;t++){let o=e[t];r.set(n,t,this.get(i,o))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){return this.constructor.copy(this,new Mr(this.rows,this.columns))}static copy(t,e){for(const[r,n,i]of t.entries())e.set(r,n,i);return e}sum(t){switch(t){case"row":return function(t){let e=dr(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=dr(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=dr(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=dr(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!ir(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,i=t.columns,o=[];for(let s=0;s<n;s++){let n=0,a=0,l=0;for(let e=0;e<i;e++)l=t.get(s,e)-r[s],n+=l,a+=l*l;e?o.push((a-n*n/i)/(i-1)):o.push((a-n*n/i)/i)}return o}(this,r,n);case"column":if(!ir(n))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,i=t.columns,o=[];for(let s=0;s<i;s++){let i=0,a=0,l=0;for(let e=0;e<n;e++)l=t.get(e,s)-r[s],i+=l,a+=l*l;e?o.push((a-i*i/n)/(n-1)):o.push((a-i*i/n)/n)}return o}(this,r,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,i=t.columns,o=n*i;let s=0,a=0,l=0;for(let e=0;e<n;e++)for(let n=0;n<i;n++)l=t.get(e,n)-r,s+=l,a+=l*l;return e?(a-s*s/o)/(o-1):(a-s*s/o)/o}(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!ir(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,r),this;case"column":if(!ir(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=t.get(r,e)**2/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!ir(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=t.get(e,r)**2/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!ir(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let i=0;i<t.rows;i++)r+=t.get(i,n)**2/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return lr(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function br(t,e){return t-e}function xr(t){return t.every((t=>"number"==typeof t))}vr.prototype.klass="Matrix","undefined"!=typeof Symbol&&(vr.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return lr(this)}),vr.random=vr.rand,vr.randomInt=vr.randInt,vr.diagonal=vr.diag,vr.prototype.diagonal=vr.prototype.diag,vr.identity=vr.eye,vr.prototype.negate=vr.prototype.neg,vr.prototype.tensorProduct=vr.prototype.kroneckerProduct;class Mr extends vr{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(t,e){if(super(),Mr.isMatrix(t))this.#t(t.rows,t.columns),Mr.copy(t,this);else if(Number.isInteger(t)&&t>=0)this.#t(t,e);else{if(!ir(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!xr(r[n]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[n]))}this.rows=t,this.columns=e}}}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return hr(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),hr(this,t,!0),e=Float64Array.from(gr(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){fr(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),fr(this,t,!0),e=pr(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let i=0;for(;i<t;i++)n[i]=this.data[r][i];for(n[i++]=e[r];i<this.columns+1;i++)n[i]=this.data[r][i-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t);return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t.get(e,r));return this}}(vr,Mr);class _r extends vr{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}}class Sr extends _r{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}}class kr extends vr{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}class Er{constructor(t){let e,r,n,i,o,s,a,l,c,u=(t=kr.checkMatrix(t)).clone(),h=u.rows,f=u.columns,g=new Float64Array(h),p=1;for(e=0;e<h;e++)g[e]=e;for(l=new Float64Array(h),r=0;r<f;r++){for(e=0;e<h;e++)l[e]=u.get(e,r);for(e=0;e<h;e++){for(c=Math.min(e,r),o=0,n=0;n<c;n++)o+=u.get(e,n)*l[n];l[e]-=o,u.set(e,r,l[e])}for(i=r,e=r+1;e<h;e++)Math.abs(l[e])>Math.abs(l[i])&&(i=e);if(i!==r){for(n=0;n<f;n++)s=u.get(i,n),u.set(i,n,u.get(r,n)),u.set(r,n,s);a=g[i],g[i]=g[r],g[r]=a,p=-p}if(r<h&&0!==u.get(r,r))for(e=r+1;e<h;e++)u.set(e,r,u.get(e,r)/u.get(r,r))}this.LU=u,this.pivotVector=g,this.pivotSign=p}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=Mr.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r,n,i,o=t.columns,s=t.subMatrixRow(this.pivotVector,0,o-1),a=e.columns;for(i=0;i<a;i++)for(r=i+1;r<a;r++)for(n=0;n<o;n++)s.set(r,n,s.get(r,n)-s.get(i,n)*e.get(r,i));for(i=a-1;i>=0;i--){for(n=0;n<o;n++)s.set(i,n,s.get(i,n)/e.get(i,i));for(r=0;r<i;r++)for(n=0;n<o;n++)s.set(r,n,s.get(r,n)-s.get(i,n)*e.get(r,i))}return s}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let n=0;n<r;n++)e*=t.get(n,n);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new Mr(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i>e?n.set(i,e,t.get(i,e)):i===e?n.set(i,e,1):n.set(i,e,0);return n}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new Mr(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i<=e?n.set(i,e,t.get(i,e)):n.set(i,e,0);return n}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function Nr(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class Ar{constructor(t){let e,r,n,i,o=(t=kr.checkMatrix(t)).clone(),s=t.rows,a=t.columns,l=new Float64Array(a);for(n=0;n<a;n++){let t=0;for(e=n;e<s;e++)t=Nr(t,o.get(e,n));if(0!==t){for(o.get(n,n)<0&&(t=-t),e=n;e<s;e++)o.set(e,n,o.get(e,n)/t);for(o.set(n,n,o.get(n,n)+1),r=n+1;r<a;r++){for(i=0,e=n;e<s;e++)i+=o.get(e,n)*o.get(e,r);for(i=-i/o.get(n,n),e=n;e<s;e++)o.set(e,r,o.get(e,r)+i*o.get(e,n))}}l[n]=-t}this.QR=o,this.Rdiag=l}solve(t){t=Mr.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let n,i,o,s,a=t.columns,l=t.clone(),c=e.columns;for(o=0;o<c;o++)for(i=0;i<a;i++){for(s=0,n=o;n<r;n++)s+=e.get(n,o)*l.get(n,i);for(s=-s/e.get(o,o),n=o;n<r;n++)l.set(n,i,l.get(n,i)+s*e.get(n,o))}for(o=c-1;o>=0;o--){for(i=0;i<a;i++)l.set(o,i,l.get(o,i)/this.Rdiag[o]);for(n=0;n<o;n++)for(i=0;i<a;i++)l.set(n,i,l.get(n,i)-l.get(o,i)*e.get(n,o))}return l.subMatrix(0,c-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,n=r.columns,i=new Mr(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)t<e?i.set(t,e,r.get(t,e)):t===e?i.set(t,e,this.Rdiag[t]):i.set(t,e,0);return i}get orthogonalMatrix(){let t,e,r,n,i=this.QR,o=i.rows,s=i.columns,a=new Mr(o,s);for(r=s-1;r>=0;r--){for(t=0;t<o;t++)a.set(t,r,0);for(a.set(r,r,1),e=r;e<s;e++)if(0!==i.get(r,r)){for(n=0,t=r;t<o;t++)n+=i.get(t,r)*a.get(t,e);for(n=-n/i.get(r,r),t=r;t<o;t++)a.set(t,e,a.get(t,e)+n*i.get(t,r))}}return a}}class Rr{constructor(t,e={}){if((t=kr.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:o=!0,autoTranspose:s=!1}=e;let a,l=Boolean(i),c=Boolean(o),u=!1;if(r<n)if(s){a=t.transpose(),r=a.rows,n=a.columns,u=!0;let e=l;l=c,c=e}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();let h=Math.min(r,n),f=Math.min(r+1,n),g=new Float64Array(f),p=new Mr(r,h),m=new Mr(n,n),d=new Float64Array(n),y=new Float64Array(r),w=new Float64Array(f);for(let t=0;t<f;t++)w[t]=t;let v=Math.min(r-1,n),b=Math.max(0,Math.min(n-2,r)),x=Math.max(v,b);for(let t=0;t<x;t++){if(t<v){g[t]=0;for(let e=t;e<r;e++)g[t]=Nr(g[t],a.get(e,t));if(0!==g[t]){a.get(t,t)<0&&(g[t]=-g[t]);for(let e=t;e<r;e++)a.set(e,t,a.get(e,t)/g[t]);a.set(t,t,a.get(t,t)+1)}g[t]=-g[t]}for(let e=t+1;e<n;e++){if(t<v&&0!==g[t]){let n=0;for(let i=t;i<r;i++)n+=a.get(i,t)*a.get(i,e);n=-n/a.get(t,t);for(let i=t;i<r;i++)a.set(i,e,a.get(i,e)+n*a.get(i,t))}d[e]=a.get(t,e)}if(l&&t<v)for(let e=t;e<r;e++)p.set(e,t,a.get(e,t));if(t<b){d[t]=0;for(let e=t+1;e<n;e++)d[t]=Nr(d[t],d[e]);if(0!==d[t]){d[t+1]<0&&(d[t]=0-d[t]);for(let e=t+1;e<n;e++)d[e]/=d[t];d[t+1]+=1}if(d[t]=-d[t],t+1<r&&0!==d[t]){for(let e=t+1;e<r;e++)y[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)y[e]+=d[r]*a.get(e,r);for(let e=t+1;e<n;e++){let n=-d[e]/d[t+1];for(let i=t+1;i<r;i++)a.set(i,e,a.get(i,e)+n*y[i])}}if(c)for(let e=t+1;e<n;e++)m.set(e,t,d[e])}}let M=Math.min(n,r+1);if(v<n&&(g[v]=a.get(v,v)),r<M&&(g[M-1]=0),b+1<M&&(d[b]=a.get(b,M-1)),d[M-1]=0,l){for(let t=v;t<h;t++){for(let e=0;e<r;e++)p.set(e,t,0);p.set(t,t,1)}for(let t=v-1;t>=0;t--)if(0!==g[t]){for(let e=t+1;e<h;e++){let n=0;for(let i=t;i<r;i++)n+=p.get(i,t)*p.get(i,e);n=-n/p.get(t,t);for(let i=t;i<r;i++)p.set(i,e,p.get(i,e)+n*p.get(i,t))}for(let e=t;e<r;e++)p.set(e,t,-p.get(e,t));p.set(t,t,1+p.get(t,t));for(let e=0;e<t-1;e++)p.set(e,t,0)}else{for(let e=0;e<r;e++)p.set(e,t,0);p.set(t,t,1)}}if(c)for(let t=n-1;t>=0;t--){if(t<b&&0!==d[t])for(let e=t+1;e<n;e++){let r=0;for(let i=t+1;i<n;i++)r+=m.get(i,t)*m.get(i,e);r=-r/m.get(t+1,t);for(let i=t+1;i<n;i++)m.set(i,e,m.get(i,e)+r*m.get(i,t))}for(let e=0;e<n;e++)m.set(e,t,0);m.set(t,t,1)}let _=M-1,S=Number.EPSILON;for(;M>0;){let t,e;for(t=M-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(g[t]+Math.abs(g[t+1]));if(Math.abs(d[t])<=e||Number.isNaN(d[t])){d[t]=0;break}}if(t===M-2)e=4;else{let r;for(r=M-1;r>=t&&r!==t;r--){let e=(r!==M?Math.abs(d[r]):0)+(r!==t+1?Math.abs(d[r-1]):0);if(Math.abs(g[r])<=S*e){g[r]=0;break}}r===t?e=3:r===M-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=d[M-2];d[M-2]=0;for(let r=M-2;r>=t;r--){let i=Nr(g[r],e),o=g[r]/i,s=e/i;if(g[r]=i,r!==t&&(e=-s*d[r-1],d[r-1]=o*d[r-1]),c)for(let t=0;t<n;t++)i=o*m.get(t,r)+s*m.get(t,M-1),m.set(t,M-1,-s*m.get(t,r)+o*m.get(t,M-1)),m.set(t,r,i)}break}case 2:{let e=d[t-1];d[t-1]=0;for(let n=t;n<M;n++){let i=Nr(g[n],e),o=g[n]/i,s=e/i;if(g[n]=i,e=-s*d[n],d[n]=o*d[n],l)for(let e=0;e<r;e++)i=o*p.get(e,n)+s*p.get(e,t-1),p.set(e,t-1,-s*p.get(e,n)+o*p.get(e,t-1)),p.set(e,n,i)}break}case 3:{const e=Math.max(Math.abs(g[M-1]),Math.abs(g[M-2]),Math.abs(d[M-2]),Math.abs(g[t]),Math.abs(d[t])),i=g[M-1]/e,o=g[M-2]/e,s=d[M-2]/e,a=g[t]/e,u=d[t]/e,h=((o+i)*(o-i)+s*s)/2,f=i*s*(i*s);let y=0;0===h&&0===f||(y=h<0?0-Math.sqrt(h*h+f):Math.sqrt(h*h+f),y=f/(h+y));let w=(a+i)*(a-i)+y,v=a*u;for(let e=t;e<M-1;e++){let i=Nr(w,v);0===i&&(i=Number.MIN_VALUE);let o=w/i,s=v/i;if(e!==t&&(d[e-1]=i),w=o*g[e]+s*d[e],d[e]=o*d[e]-s*g[e],v=s*g[e+1],g[e+1]=o*g[e+1],c)for(let t=0;t<n;t++)i=o*m.get(t,e)+s*m.get(t,e+1),m.set(t,e+1,-s*m.get(t,e)+o*m.get(t,e+1)),m.set(t,e,i);if(i=Nr(w,v),0===i&&(i=Number.MIN_VALUE),o=w/i,s=v/i,g[e]=i,w=o*d[e]+s*g[e+1],g[e+1]=-s*d[e]+o*g[e+1],v=s*d[e+1],d[e+1]=o*d[e+1],l&&e<r-1)for(let t=0;t<r;t++)i=o*p.get(t,e)+s*p.get(t,e+1),p.set(t,e+1,-s*p.get(t,e)+o*p.get(t,e+1)),p.set(t,e,i)}d[M-2]=w;break}case 4:if(g[t]<=0&&(g[t]=g[t]<0?-g[t]:0,c))for(let e=0;e<=_;e++)m.set(e,t,-m.get(e,t));for(;t<_&&!(g[t]>=g[t+1]);){let e=g[t];if(g[t]=g[t+1],g[t+1]=e,c&&t<n-1)for(let r=0;r<n;r++)e=m.get(r,t+1),m.set(r,t+1,m.get(r,t)),m.set(r,t,e);if(l&&t<r-1)for(let n=0;n<r;n++)e=p.get(n,t+1),p.set(n,t+1,p.get(n,t)),p.set(n,t,e);t++}M--}}if(u){let t=m;m=p,p=t}this.m=r,this.n=n,this.s=g,this.U=p,this.V=m}solve(t){let e=t,r=this.threshold,n=this.s.length,i=Mr.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?i.set(t,t,0):i.set(t,t,1/this.s[t]);let o=this.U,s=this.rightSingularVectors,a=s.mmul(i),l=s.rows,c=o.rows,u=Mr.zeros(l,c);for(let t=0;t<l;t++)for(let e=0;e<c;e++){let r=0;for(let i=0;i<n;i++)r+=a.get(t,i)*o.get(e,i);u.set(t,e,r)}return u.mmul(e)}solveForDiagonal(t){return this.solve(Mr.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,i=new Mr(r,this.s.length);for(let o=0;o<r;o++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&i.set(o,r,t.get(o,r)/this.s[r]);let o=this.U,s=o.rows,a=o.columns,l=new Mr(r,s);for(let t=0;t<r;t++)for(let e=0;e<s;e++){let r=0;for(let n=0;n<a;n++)r+=i.get(t,n)*o.get(e,n);l.set(t,e,r)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,i=r.length;n<i;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Mr.diag(this.s)}}function Cr(t,e=!1){return t=kr.checkMatrix(t),e?new Rr(t).inverse():function(t,e,r=!1){return t=kr.checkMatrix(t),e=kr.checkMatrix(e),r?new Rr(t).solve(e):t.isSquare()?new Er(t).solve(e):new Ar(t).solve(e)}(t,Mr.eye(t.rows))}class Pr{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(!(t=kr.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let n,i,o=t.columns,s=new Mr(o,o),a=new Float64Array(o),l=new Float64Array(o),c=t,u=!1;if(u=!!r||t.isSymmetric(),u){for(n=0;n<o;n++)for(i=0;i<o;i++)s.set(n,i,c.get(n,i));!function(t,e,r,n){let i,o,s,a,l,c,u,h;for(l=0;l<t;l++)r[l]=n.get(t-1,l);for(a=t-1;a>0;a--){for(h=0,s=0,c=0;c<a;c++)h+=Math.abs(r[c]);if(0===h)for(e[a]=r[a-1],l=0;l<a;l++)r[l]=n.get(a-1,l),n.set(a,l,0),n.set(l,a,0);else{for(c=0;c<a;c++)r[c]/=h,s+=r[c]*r[c];for(i=r[a-1],o=Math.sqrt(s),i>0&&(o=-o),e[a]=h*o,s-=i*o,r[a-1]=i-o,l=0;l<a;l++)e[l]=0;for(l=0;l<a;l++){for(i=r[l],n.set(l,a,i),o=e[l]+n.get(l,l)*i,c=l+1;c<=a-1;c++)o+=n.get(c,l)*r[c],e[c]+=n.get(c,l)*i;e[l]=o}for(i=0,l=0;l<a;l++)e[l]/=s,i+=e[l]*r[l];for(u=i/(s+s),l=0;l<a;l++)e[l]-=u*r[l];for(l=0;l<a;l++){for(i=r[l],o=e[l],c=l;c<=a-1;c++)n.set(c,l,n.get(c,l)-(i*e[c]+o*r[c]));r[l]=n.get(a-1,l),n.set(a,l,0)}}r[a]=s}for(a=0;a<t-1;a++){if(n.set(t-1,a,n.get(a,a)),n.set(a,a,1),s=r[a+1],0!==s){for(c=0;c<=a;c++)r[c]=n.get(c,a+1)/s;for(l=0;l<=a;l++){for(o=0,c=0;c<=a;c++)o+=n.get(c,a+1)*n.get(c,l);for(c=0;c<=a;c++)n.set(c,l,n.get(c,l)-o*r[c])}}for(c=0;c<=a;c++)n.set(c,a+1,0)}for(l=0;l<t;l++)r[l]=n.get(t-1,l),n.set(t-1,l,0);n.set(t-1,t-1,1),e[0]=0}(o,l,a,s),function(t,e,r,n){let i,o,s,a,l,c,u,h,f,g,p,m,d,y,w,v;for(s=1;s<t;s++)e[s-1]=e[s];e[t-1]=0;let b=0,x=0,M=Number.EPSILON;for(c=0;c<t;c++){for(x=Math.max(x,Math.abs(r[c])+Math.abs(e[c])),u=c;u<t&&!(Math.abs(e[u])<=M*x);)u++;if(u>c)do{for(i=r[c],h=(r[c+1]-i)/(2*e[c]),f=Nr(h,1),h<0&&(f=-f),r[c]=e[c]/(h+f),r[c+1]=e[c]*(h+f),g=r[c+1],o=i-r[c],s=c+2;s<t;s++)r[s]-=o;for(b+=o,h=r[u],p=1,m=p,d=p,y=e[c+1],w=0,v=0,s=u-1;s>=c;s--)for(d=m,m=p,v=w,i=p*e[s],o=p*h,f=Nr(h,e[s]),e[s+1]=w*f,w=e[s]/f,p=h/f,h=p*r[s]-w*i,r[s+1]=o+w*(p*i+w*r[s]),l=0;l<t;l++)o=n.get(l,s+1),n.set(l,s+1,w*n.get(l,s)+p*o),n.set(l,s,p*n.get(l,s)-w*o);h=-w*v*d*y*e[c]/g,e[c]=w*h,r[c]=p*h}while(Math.abs(e[c])>M*x);r[c]=r[c]+b,e[c]=0}for(s=0;s<t-1;s++){for(l=s,h=r[s],a=s+1;a<t;a++)r[a]<h&&(l=a,h=r[a]);if(l!==s)for(r[l]=r[s],r[s]=h,a=0;a<t;a++)h=n.get(a,s),n.set(a,s,n.get(a,l)),n.set(a,l,h)}}(o,l,a,s)}else{let t=new Mr(o,o),e=new Float64Array(o);for(i=0;i<o;i++)for(n=0;n<o;n++)t.set(n,i,c.get(n,i));!function(t,e,r,n){let i,o,s,a,l,c,u,h=0,f=t-1;for(c=h+1;c<=f-1;c++){for(u=0,a=c;a<=f;a++)u+=Math.abs(e.get(a,c-1));if(0!==u){for(s=0,a=f;a>=c;a--)r[a]=e.get(a,c-1)/u,s+=r[a]*r[a];for(o=Math.sqrt(s),r[c]>0&&(o=-o),s-=r[c]*o,r[c]=r[c]-o,l=c;l<t;l++){for(i=0,a=f;a>=c;a--)i+=r[a]*e.get(a,l);for(i/=s,a=c;a<=f;a++)e.set(a,l,e.get(a,l)-i*r[a])}for(a=0;a<=f;a++){for(i=0,l=f;l>=c;l--)i+=r[l]*e.get(a,l);for(i/=s,l=c;l<=f;l++)e.set(a,l,e.get(a,l)-i*r[l])}r[c]=u*r[c],e.set(c,c-1,u*o)}}for(a=0;a<t;a++)for(l=0;l<t;l++)n.set(a,l,a===l?1:0);for(c=f-1;c>=h+1;c--)if(0!==e.get(c,c-1)){for(a=c+1;a<=f;a++)r[a]=e.get(a,c-1);for(l=c;l<=f;l++){for(o=0,a=c;a<=f;a++)o+=r[a]*n.get(a,l);for(o=o/r[c]/e.get(c,c-1),a=c;a<=f;a++)n.set(a,l,n.get(a,l)+o*r[a])}}}(o,t,e,s),function(t,e,r,n,i){let o,s,a,l,c,u,h,f,g,p,m,d,y,w,v,b=t-1,x=0,M=t-1,_=Number.EPSILON,S=0,k=0,E=0,N=0,A=0,R=0,C=0,P=0;for(o=0;o<t;o++)for((o<x||o>M)&&(r[o]=i.get(o,o),e[o]=0),s=Math.max(o-1,0);s<t;s++)k+=Math.abs(i.get(o,s));for(;b>=x;){for(l=b;l>x&&(R=Math.abs(i.get(l-1,l-1))+Math.abs(i.get(l,l)),0===R&&(R=k),!(Math.abs(i.get(l,l-1))<_*R));)l--;if(l===b)i.set(b,b,i.get(b,b)+S),r[b]=i.get(b,b),e[b]=0,b--,P=0;else if(l===b-1){if(h=i.get(b,b-1)*i.get(b-1,b),E=(i.get(b-1,b-1)-i.get(b,b))/2,N=E*E+h,C=Math.sqrt(Math.abs(N)),i.set(b,b,i.get(b,b)+S),i.set(b-1,b-1,i.get(b-1,b-1)+S),f=i.get(b,b),N>=0){for(C=E>=0?E+C:E-C,r[b-1]=f+C,r[b]=r[b-1],0!==C&&(r[b]=f-h/C),e[b-1]=0,e[b]=0,f=i.get(b,b-1),R=Math.abs(f)+Math.abs(C),E=f/R,N=C/R,A=Math.sqrt(E*E+N*N),E/=A,N/=A,s=b-1;s<t;s++)C=i.get(b-1,s),i.set(b-1,s,N*C+E*i.get(b,s)),i.set(b,s,N*i.get(b,s)-E*C);for(o=0;o<=b;o++)C=i.get(o,b-1),i.set(o,b-1,N*C+E*i.get(o,b)),i.set(o,b,N*i.get(o,b)-E*C);for(o=x;o<=M;o++)C=n.get(o,b-1),n.set(o,b-1,N*C+E*n.get(o,b)),n.set(o,b,N*n.get(o,b)-E*C)}else r[b-1]=f+E,r[b]=f+E,e[b-1]=C,e[b]=-C;b-=2,P=0}else{if(f=i.get(b,b),g=0,h=0,l<b&&(g=i.get(b-1,b-1),h=i.get(b,b-1)*i.get(b-1,b)),10===P){for(S+=f,o=x;o<=b;o++)i.set(o,o,i.get(o,o)-f);R=Math.abs(i.get(b,b-1))+Math.abs(i.get(b-1,b-2)),f=g=.75*R,h=-.4375*R*R}if(30===P&&(R=(g-f)/2,R=R*R+h,R>0)){for(R=Math.sqrt(R),g<f&&(R=-R),R=f-h/((g-f)/2+R),o=x;o<=b;o++)i.set(o,o,i.get(o,o)-R);S+=R,f=g=h=.964}for(P+=1,c=b-2;c>=l&&(C=i.get(c,c),A=f-C,R=g-C,E=(A*R-h)/i.get(c+1,c)+i.get(c,c+1),N=i.get(c+1,c+1)-C-A-R,A=i.get(c+2,c+1),R=Math.abs(E)+Math.abs(N)+Math.abs(A),E/=R,N/=R,A/=R,c!==l)&&!(Math.abs(i.get(c,c-1))*(Math.abs(N)+Math.abs(A))<_*(Math.abs(E)*(Math.abs(i.get(c-1,c-1))+Math.abs(C)+Math.abs(i.get(c+1,c+1)))));)c--;for(o=c+2;o<=b;o++)i.set(o,o-2,0),o>c+2&&i.set(o,o-3,0);for(a=c;a<=b-1&&(w=a!==b-1,a!==c&&(E=i.get(a,a-1),N=i.get(a+1,a-1),A=w?i.get(a+2,a-1):0,f=Math.abs(E)+Math.abs(N)+Math.abs(A),0!==f&&(E/=f,N/=f,A/=f)),0!==f);a++)if(R=Math.sqrt(E*E+N*N+A*A),E<0&&(R=-R),0!==R){for(a!==c?i.set(a,a-1,-R*f):l!==c&&i.set(a,a-1,-i.get(a,a-1)),E+=R,f=E/R,g=N/R,C=A/R,N/=E,A/=E,s=a;s<t;s++)E=i.get(a,s)+N*i.get(a+1,s),w&&(E+=A*i.get(a+2,s),i.set(a+2,s,i.get(a+2,s)-E*C)),i.set(a,s,i.get(a,s)-E*f),i.set(a+1,s,i.get(a+1,s)-E*g);for(o=0;o<=Math.min(b,a+3);o++)E=f*i.get(o,a)+g*i.get(o,a+1),w&&(E+=C*i.get(o,a+2),i.set(o,a+2,i.get(o,a+2)-E*A)),i.set(o,a,i.get(o,a)-E),i.set(o,a+1,i.get(o,a+1)-E*N);for(o=x;o<=M;o++)E=f*n.get(o,a)+g*n.get(o,a+1),w&&(E+=C*n.get(o,a+2),n.set(o,a+2,n.get(o,a+2)-E*A)),n.set(o,a,n.get(o,a)-E),n.set(o,a+1,n.get(o,a+1)-E*N)}}}if(0===k)return;for(b=t-1;b>=0;b--)if(E=r[b],N=e[b],0===N)for(l=b,i.set(b,b,1),o=b-1;o>=0;o--){for(h=i.get(o,o)-E,A=0,s=l;s<=b;s++)A+=i.get(o,s)*i.get(s,b);if(e[o]<0)C=h,R=A;else if(l=o,0===e[o]?i.set(o,b,0!==h?-A/h:-A/(_*k)):(f=i.get(o,o+1),g=i.get(o+1,o),N=(r[o]-E)*(r[o]-E)+e[o]*e[o],u=(f*R-C*A)/N,i.set(o,b,u),i.set(o+1,b,Math.abs(f)>Math.abs(C)?(-A-h*u)/f:(-R-g*u)/C)),u=Math.abs(i.get(o,b)),_*u*u>1)for(s=o;s<=b;s++)i.set(s,b,i.get(s,b)/u)}else if(N<0)for(l=b-1,Math.abs(i.get(b,b-1))>Math.abs(i.get(b-1,b))?(i.set(b-1,b-1,N/i.get(b,b-1)),i.set(b-1,b,-(i.get(b,b)-E)/i.get(b,b-1))):(v=zr(0,-i.get(b-1,b),i.get(b-1,b-1)-E,N),i.set(b-1,b-1,v[0]),i.set(b-1,b,v[1])),i.set(b,b-1,0),i.set(b,b,1),o=b-2;o>=0;o--){for(p=0,m=0,s=l;s<=b;s++)p+=i.get(o,s)*i.get(s,b-1),m+=i.get(o,s)*i.get(s,b);if(h=i.get(o,o)-E,e[o]<0)C=h,A=p,R=m;else if(l=o,0===e[o]?(v=zr(-p,-m,h,N),i.set(o,b-1,v[0]),i.set(o,b,v[1])):(f=i.get(o,o+1),g=i.get(o+1,o),d=(r[o]-E)*(r[o]-E)+e[o]*e[o]-N*N,y=2*(r[o]-E)*N,0===d&&0===y&&(d=_*k*(Math.abs(h)+Math.abs(N)+Math.abs(f)+Math.abs(g)+Math.abs(C))),v=zr(f*A-C*p+N*m,f*R-C*m-N*p,d,y),i.set(o,b-1,v[0]),i.set(o,b,v[1]),Math.abs(f)>Math.abs(C)+Math.abs(N)?(i.set(o+1,b-1,(-p-h*i.get(o,b-1)+N*i.get(o,b))/f),i.set(o+1,b,(-m-h*i.get(o,b)-N*i.get(o,b-1))/f)):(v=zr(-A-g*i.get(o,b-1),-R-g*i.get(o,b),C,N),i.set(o+1,b-1,v[0]),i.set(o+1,b,v[1]))),u=Math.max(Math.abs(i.get(o,b-1)),Math.abs(i.get(o,b))),_*u*u>1)for(s=o;s<=b;s++)i.set(s,b-1,i.get(s,b-1)/u),i.set(s,b,i.get(s,b)/u)}for(o=0;o<t;o++)if(o<x||o>M)for(s=o;s<t;s++)n.set(o,s,i.get(o,s));for(s=t-1;s>=x;s--)for(o=x;o<=M;o++){for(C=0,a=x;a<=Math.min(s,M);a++)C+=n.get(o,a)*i.get(a,s);n.set(o,s,C)}}(o,l,a,s,t)}this.n=o,this.e=l,this.d=a,this.V=s}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,n=this.e,i=this.d,o=new Mr(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)o.set(t,e,0);o.set(t,t,i[t]),n[t]>0?o.set(t,t+1,n[t]):n[t]<0&&o.set(t,t-1,n[t])}return o}}function zr(t,e,r,n){let i,o;return Math.abs(r)>Math.abs(n)?(i=n/r,o=r+i*n,[(t+i*e)/o,(e-i*t)/o]):(i=r/n,o=n+i*r,[(i*t+e)/o,(i*e-t)/o])}class $r{constructor(t,e={}){t=kr.checkMatrix(t);let{Y:r}=e;const{scaleScores:n=!1,maxIterations:i=1e3,terminationCriteria:o=1e-10}=e;let s;if(r){if(r=ir(r)&&"number"==typeof r[0]?Mr.columnVector(r):kr.checkMatrix(r),r.rows!==t.rows)throw new Error("Y should have the same number of rows as X");s=r.getColumnVector(0)}else s=t.getColumnVector(0);let a,l,c,u,h=1;for(let e=0;e<i&&h>o;e++)c=t.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0)),c=c.div(c.norm()),a=t.mmul(c).div(c.transpose().mmul(c).get(0,0)),e>0&&(h=a.clone().sub(u).pow(2).sum()),u=a.clone(),r?(l=r.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),l=l.div(l.norm()),s=r.mmul(l).div(l.transpose().mmul(l).get(0,0))):s=a;if(r){let e=t.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0));e=e.div(e.norm());let n=t.clone().sub(a.clone().mmul(e.transpose())),i=s.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),o=r.clone().sub(a.clone().mulS(i.get(0,0)).mmul(l.transpose()));this.t=a,this.p=e.transpose(),this.w=c.transpose(),this.q=l,this.u=s,this.s=a.transpose().mmul(a),this.xResidual=n,this.yResidual=o,this.betas=i}else this.w=c.transpose(),this.s=a.transpose().mmul(a).sqrt(),this.t=n?a.clone().div(this.s.get(0,0)):a,this.xResidual=t.sub(a.mmul(c.transpose()))}}class Ir{constructor(t,e={},r){if(this.U=null,this.S=null,r)return this.center=r.center,this.scale=r.scale,this.means=r.means,this.stdevs=r.stdevs,this.U=Mr.checkMatrix(r.U),this.S=r.S,this.R=r.R,void(this.excludedFeatures=r.excludedFeatures||[]);let n;n=(Array.isArray(t),new Mr(t));const{isCovarianceMatrix:i=!1,method:o="SVD",nCompNIPALS:s=2,center:a=!0,scale:l=!1,ignoreZeroVariance:c=!1}=e;if(this.center=a,this.scale=l,this.means=null,this.stdevs=null,this.excludedFeatures=[],i)this._computeFromCovarianceMatrix(n);else switch(this._adjust(n,c),o){case"covarianceMatrix":{const t=new Sr(n).mmul(n).div(n.rows-1);this._computeFromCovarianceMatrix(t);break}case"NIPALS":this._computeWithNIPALS(n,s);break;case"SVD":{const t=new Rr(n,{computeLeftSingularVectors:!1,computeRightSingularVectors:!0,autoTranspose:!0});this.U=t.rightSingularVectors;const e=t.diagonal,r=[];for(const t of e)r.push(t*t/(n.rows-1));this.S=r;break}default:throw new Error(`unknown method: ${o}`)}}static load(t){if("string"!=typeof t.name)throw new TypeError("model must have a name property");if("PCA"!==t.name)throw new RangeError(`invalid model: ${t.name}`);return new Ir(void 0,void 0,t)}predict(t,e={}){const{nComponents:r=this.U.columns}=e;let n;if(n=(Array.isArray(t),new Mr(t)),this.center&&(n.subRowVector(this.means),this.scale)){for(let t of this.excludedFeatures)n.removeColumn(t);n.divRowVector(this.stdevs)}let i=n.mmul(this.U);return i.subMatrix(0,i.rows-1,0,r-1)}invert(t){let e=(t=Mr.checkMatrix(t)).mmul(this.U.transpose());return this.center&&(this.scale&&e.mulRowVector(this.stdevs),e.addRowVector(this.means)),e}getExplainedVariance(){let t=0;if(this.S)for(const e of this.S)t+=e;return this.S?this.S.map((e=>e/t)):[]}getCumulativeVariance(){let t=this.getExplainedVariance();for(let e=1;e<t.length;e++)t[e]+=t[e-1];return t}getEigenvectors(){return this.U}getEigenvalues(){return this.S}getStandardDeviations(){return this.S.map((t=>Math.sqrt(t)))}getLoadings(){return this.U.transpose()}toJSON(){return{name:"PCA",center:this.center,scale:this.scale,means:this.means,stdevs:this.stdevs,U:this.U,S:this.S,excludedFeatures:this.excludedFeatures}}_adjust(t,e){if(this.center){const r=t.mean("column"),n=this.scale?t.standardDeviation("column",{mean:r}):null;if(this.means=r,t.subRowVector(r),this.scale){for(let r=0;r<n.length;r++)if(0===n[r]){if(!e)throw new RangeError(`Cannot scale the dataset (standard deviation is zero at index ${r}`);t.removeColumn(r),n.splice(r,1),this.excludedFeatures.push(r),r--}this.stdevs=n,t.divRowVector(n)}}}_computeFromCovarianceMatrix(t){const e=new Pr(t,{assumeSymmetric:!0});this.U=e.eigenvectorMatrix,this.U.flipRows(),this.S=e.realEigenvalues,this.S.reverse()}_computeWithNIPALS(t,e){this.U=new Mr(e,t.columns),this.S=[];let r=t;for(let t=0;t<e;t++){let e=new $r(r);this.U.setRow(t,e.w.transpose()),this.S.push(Math.pow(e.s.get(0,0),2)),r=e.xResidual}this.U=this.U.transpose()}}class Tr{fit(t){try{const e=new Ir(t).predict(t,{nComponents:2});return e.data?e.data.map((t=>Array.from(t))):[]}catch(t){return console.error("Error in PCA fit:",t),[]}}}var Fr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function jr(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&r.path)}},r.exports),r.exports}var Or=jr((function(t,e){var r=Fr&&Fr.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function n(t,e){return Math.floor(e()*t)}function i(t){for(var e=[],r=0;r<t;r++)e.push(void 0);return e}function o(t,e){return i(t).map((function(){return e}))}function s(t){return o(t,0)}function a(t){return t.reduce((function(t,e){return t+e}))}Object.defineProperty(e,"__esModule",{value:!0}),e.reshape2d=e.rejectionSample=e.max2d=e.max=e.mean=e.sum=e.linear=e.ones=e.zeros=e.filled=e.range=e.empty=e.norm=e.tauRand=e.tauRandInt=void 0,e.tauRandInt=n,e.tauRand=function(t){return t()},e.norm=function(t){var e,n,i=0;try{for(var o=r(t),s=o.next();!s.done;s=o.next()){var a=s.value;i+=Math.pow(a,2)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return Math.sqrt(i)},e.empty=i,e.range=function(t){return i(t).map((function(t,e){return e}))},e.filled=o,e.zeros=s,e.ones=function(t){return o(t,1)},e.linear=function(t,e,r){return i(r).map((function(n,i){return t+i*((e-t)/(r-1))}))},e.sum=a,e.mean=function(t){return a(t)/t.length},e.max=function(t){for(var e=0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return e},e.max2d=function(t){for(var e=0,r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++)e=t[r][n]>e?t[r][n]:e;return e},e.rejectionSample=function(t,e,r){for(var i=s(t),o=0;o<t;o++)for(var a=!0;a;){for(var l=n(e,r),c=!1,u=0;u<o;u++)if(l===i[u]){c=!0;break}c||(a=!1),i[o]=l}return i},e.reshape2d=function(t,e,r){var n=[],i=0;if(t.length!==e*r)throw new Error("Array dimensions must match input length.");for(var o=0;o<e;o++){for(var s=[],a=0;a<r;a++)s.push(t[i]),i+=1;n.push(s)}return n}})),qr=jr((function(t,e){var r=Fr&&Fr.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),n=Fr&&Fr.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=Fr&&Fr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.smallestFlagged=e.deheapSort=e.buildCandidates=e.uncheckedHeapPush=e.heapPush=e.rejectionSample=e.makeHeap=void 0;var o=i(Or);function s(t,e){var r=function(r){return o.empty(t).map((function(){return o.filled(e,r)}))},n=[];return n.push(r(-1)),n.push(r(1/0)),n.push(r(0)),n}function a(t,e,r,n,i){e=Math.floor(e);var o=t[0][e],s=t[1][e];if(t[2][e],r>=s[0])return 0;for(var a=0;a<o.length;a++)if(n===o[a])return 0;return l(t,e,r,n,i)}function l(t,e,r,n,i){var o=t[0][e],s=t[1][e],a=t[2][e];if(r>=s[0])return 0;s[0]=r,o[0]=n,a[0]=i;for(var l=0,c=0;;){var u=2*l+1,h=u+1,f=t[0][0].length;if(u>=f)break;if(h>=f){if(!(s[u]>r))break;c=u}else if(s[u]>=s[h]){if(!(r<s[u]))break;c=u}else{if(!(r<s[h]))break;c=h}s[l]=s[c],o[l]=o[c],a[l]=a[c],l=c}return s[l]=r,o[l]=n,a[l]=i,1}function c(t,e,r,n){for(;2*n+1<r;){var i=2*n+1,o=i+1,s=n;if(t[s]<t[i]&&(s=i),o<r&&t[s]<t[o]&&(s=o),s===n)break;var a=t[n];t[n]=t[s],t[s]=a;var l=e[n];e[n]=e[s],e[s]=l,n=s}}e.makeHeap=s,e.rejectionSample=function(t,e,r){for(var n=o.zeros(t),i=0;i<t;i++){for(var s=!0,a=0;s;){a=o.tauRandInt(e,r);for(var l=!1,c=0;c<i;c++)if(a===n[c]){l=!0;break}l||(s=!1)}n[i]=a}return n},e.heapPush=a,e.uncheckedHeapPush=l,e.buildCandidates=function(t,e,r,n,i){for(var l=s(e,n),c=0;c<e;c++)for(var u=0;u<r;u++)if(!(t[0][c][u]<0)){var h=t[0][c][u],f=t[2][c][u],g=o.tauRand(i);a(l,c,g,h,f),a(l,h,g,c,f),t[2][c][u]=0}return l},e.deheapSort=function(t){for(var e=t[0],r=t[1],n=0;n<e.length;n++)for(var i=e[n],o=r[n],s=0;s<i.length-1;s++){var a=i.length-s-1,l=o.length-s-1,u=i[0];i[0]=i[a],i[a]=u;var h=o[0];o[0]=o[l],o[l]=h,c(o,i,l,0)}return{indices:e,weights:r}},e.smallestFlagged=function(t,e){for(var r=t[0][e],n=t[1][e],i=t[2][e],o=1/0,s=-1,a=0;a>r.length;a++)1===i[a]&&n[a]<o&&(o=n[a],s=a);return s>=0?(i[s]=0,Math.floor(r[s])):-1}})),Vr=jr((function(t,e){var r,n=Fr&&Fr.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=Fr&&Fr.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=Fr&&Fr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.hasOwnProperty.call(t,r)&&n(e,t,r);return i(e,t),e},s=Fr&&Fr.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},a=Fr&&Fr.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.getCSR=e.normalize=e.eliminateZeros=e.multiplyScalar=e.maximum=e.subtract=e.add=e.pairwiseMultiply=e.identity=e.transpose=e.SparseMatrix=void 0;var l=o(Or),c=function(){function t(t,e,r,n){if(this.entries=new Map,this.nRows=0,this.nCols=0,t.length!==e.length||t.length!==r.length)throw new Error("rows, cols and values arrays must all have the same length");this.nRows=n[0],this.nCols=n[1];for(var i=0;i<r.length;i++){var o=t[i],s=e[i];this.checkDims(o,s);var a=this.makeKey(o,s);this.entries.set(a,{value:r[i],row:o,col:s})}}return t.prototype.makeKey=function(t,e){return t+":"+e},t.prototype.checkDims=function(t,e){if(!(t<this.nRows&&e<this.nCols))throw new Error("row and/or col specified outside of matrix dimensions")},t.prototype.set=function(t,e,r){this.checkDims(t,e);var n=this.makeKey(t,e);this.entries.has(n)?this.entries.get(n).value=r:this.entries.set(n,{value:r,row:t,col:e})},t.prototype.get=function(t,e,r){void 0===r&&(r=0),this.checkDims(t,e);var n=this.makeKey(t,e);return this.entries.has(n)?this.entries.get(n).value:r},t.prototype.getAll=function(t){void 0===t&&(t=!0);var e=[];return this.entries.forEach((function(t){e.push(t)})),t&&e.sort((function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row})),e},t.prototype.getDims=function(){return[this.nRows,this.nCols]},t.prototype.getRows=function(){return Array.from(this.entries,(function(t){var e=s(t,2);return e[0],e[1].row}))},t.prototype.getCols=function(){return Array.from(this.entries,(function(t){var e=s(t,2);return e[0],e[1].col}))},t.prototype.getValues=function(){return Array.from(this.entries,(function(t){var e=s(t,2);return e[0],e[1].value}))},t.prototype.forEach=function(t){this.entries.forEach((function(e){return t(e.value,e.row,e.col)}))},t.prototype.map=function(e){var r=[];this.entries.forEach((function(t){r.push(e(t.value,t.row,t.col))}));var n=[this.nRows,this.nCols];return new t(this.getRows(),this.getCols(),r,n)},t.prototype.toArray=function(){var t=this,e=l.empty(this.nRows).map((function(){return l.zeros(t.nCols)}));return this.entries.forEach((function(t){e[t.row][t.col]=t.value})),e},t}();e.SparseMatrix=c,e.transpose=function(t){var e=[],r=[],n=[];t.forEach((function(t,i,o){e.push(i),r.push(o),n.push(t)}));var i=[t.nCols,t.nRows];return new c(r,e,n,i)},e.identity=function(t){for(var e=s(t,1)[0],r=new c([],[],[],t),n=0;n<e;n++)r.set(n,n,1);return r},e.pairwiseMultiply=function(t,e){return h(t,e,(function(t,e){return t*e}))},e.add=function(t,e){return h(t,e,(function(t,e){return t+e}))},e.subtract=function(t,e){return h(t,e,(function(t,e){return t-e}))},e.maximum=function(t,e){return h(t,e,(function(t,e){return t>e?t:e}))},e.multiplyScalar=function(t,e){return t.map((function(t){return t*e}))},e.eliminateZeros=function(t){for(var e=new Set,r=t.getValues(),n=t.getRows(),i=t.getCols(),o=0;o<r.length;o++)0===r[o]&&e.add(o);var s=function(t,r){return!e.has(r)},a=r.filter(s),l=n.filter(s),u=i.filter(s);return new c(l,u,a,t.getDims())},e.normalize=function(t,e){var r,n;void 0===e&&(e="l2");var i=u[e],o=new Map;t.forEach((function(t,e,r){var n=o.get(e)||[];n.push(r),o.set(e,n)}));var s=new c([],[],[],t.getDims()),l=function(e){for(var r=o.get(e).sort(),n=r.map((function(r){return t.get(e,r)})),a=i(n),l=0;l<a.length;l++)s.set(e,r[l],a[l])};try{for(var h=a(o.keys()),f=h.next();!f.done;f=h.next()){l(f.value)}}catch(t){r={error:t}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}return s};var u=((r={}).max=function(t){for(var e=-1/0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return t.map((function(t){return t/e}))},r.l1=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return t.map((function(t){return t/e}))},r.l2=function(t){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r],2);return t.map((function(t){return Math.sqrt(Math.pow(t,2)/e)}))},r);function h(t,e,r){for(var n=new Set,i=[],o=[],s=[],a=function(n,a){i.push(n),o.push(a);var l=r(t.get(n,a),e.get(n,a));s.push(l)},l=t.getValues(),u=t.getRows(),h=t.getCols(),f=0;f<l.length;f++){var g=(y=u[f])+":"+(w=h[f]);n.add(g),a(y,w)}var p=e.getValues(),m=e.getRows(),d=e.getCols();for(f=0;f<p.length;f++){var y,w;g=(y=m[f])+":"+(w=d[f]);n.has(g)||a(y,w)}var v=[t.nRows,t.nCols];return new c(i,o,s,v)}e.getCSR=function(t){var e=[];t.forEach((function(t,r,n){e.push({value:t,row:r,col:n})})),e.sort((function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row}));for(var r=[],n=[],i=[],o=-1,s=0;s<e.length;s++){var a=e[s],l=a.row,c=a.col,u=a.value;l!==o&&(o=l,i.push(s)),r.push(c),n.push(u)}return{indices:r,values:n,indptr:i}}})),Dr=jr((function(t,e){var r=Fr&&Fr.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),n=Fr&&Fr.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=Fr&&Fr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e},o=Fr&&Fr.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},s=Fr&&Fr.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},a=Fr&&Fr.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.searchFlatTree=e.makeLeafArray=e.makeForest=e.FlatTree=void 0;var l=i(Or),c=function(t,e,r,n){this.hyperplanes=t,this.offsets=e,this.children=r,this.indices=n};function u(t,e,r,n,i){if(void 0===r&&(r=30),e.length>r){var o=function(t,e,r){var n=t[0].length,i=l.tauRandInt(e.length,r),o=l.tauRandInt(e.length,r);o=(o+=i===o?1:0)%e.length;for(var s=e[i],a=e[o],c=0,u=l.zeros(n),h=0;h<u.length;h++)u[h]=t[s][h]-t[a][h],c-=u[h]*(t[s][h]+t[a][h])/2;var f=0,g=0,p=l.zeros(e.length);for(h=0;h<e.length;h++){for(var m=c,d=0;d<n;d++)m+=u[d]*t[e[h]][d];0===m?(p[h]=l.tauRandInt(2,r),0===p[h]?f+=1:g+=1):m>0?(p[h]=0,f+=1):(p[h]=1,g+=1)}var y=l.zeros(f),w=l.zeros(g);f=0,g=0;for(h=0;h<p.length;h++)0===p[h]?(y[f]=e[h],f+=1):(w[g]=e[h],g+=1);return{indicesLeft:y,indicesRight:w,hyperplane:u,offset:c}}(t,e,i),s=o.indicesLeft,a=o.indicesRight,c=o.hyperplane,h=o.offset;return{leftChild:u(t,s,r,n+1,i),rightChild:u(t,a,r,n+1,i),isLeaf:!1,hyperplane:c,offset:h}}return{indices:e,isLeaf:!0}}function h(t,e,r,n,i,o,a){var l;if(t.isLeaf)return n[o][0]=-a,(l=i[a]).splice.apply(l,s([0,t.indices.length],t.indices)),{nodeNum:o,leafNum:a+=1};e[o]=t.hyperplane,r[o]=t.offset,n[o][0]=o+1;var c=o,u=h(t.leftChild,e,r,n,i,o+1,a);return o=u.nodeNum,a=u.leafNum,n[c][1]=o+1,{nodeNum:(u=h(t.rightChild,e,r,n,i,o+1,a)).nodeNum,leafNum:u.leafNum}}function f(t){return t.isLeaf?1:1+f(t.leftChild)+f(t.rightChild)}function g(t){return t.isLeaf?1:g(t.leftChild)+g(t.rightChild)}function p(t,e,r,n){for(var i=e,o=0;o<r.length;o++)i+=t[o]*r[o];return 0===i?l.tauRandInt(2,n):i>0?0:1}e.FlatTree=c,e.makeForest=function(t,e,r,n){var i=Math.max(10,e),o=l.range(r).map((function(e,r){return function(t,e,r,n){void 0===e&&(e=30);var i=l.range(t.length),o=u(t,i,e,r,n);return o}(t,i,r,n)})),s=o.map((function(t){return function(t,e){var r=f(t),n=g(t),i=l.range(r).map((function(){return l.zeros(t.hyperplane?t.hyperplane.length:0)})),o=l.zeros(r),s=l.range(r).map((function(){return[-1,-1]})),a=l.range(n).map((function(){return l.range(e).map((function(){return-1}))}));return h(t,i,o,s,a,0,0),new c(i,o,s,a)}(t,i)}));return s},e.makeLeafArray=function(t){var e,r;if(t.length>0){var n=[];try{for(var i=a(t),o=i.next();!o.done;o=i.next()){var l=o.value;n.push.apply(n,s(l.indices))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}return[[-1]]},e.searchFlatTree=function(t,e,r){for(var n=0;e.children[n][0]>0;){n=0===p(e.hyperplanes[n],e.offsets[n],t,r)?e.children[n][0]:e.children[n][1]}var i=-1*e.children[n][0];return e.indices[i]}})),Lr=jr((function(t,e){var r=Fr&&Fr.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),n=Fr&&Fr.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=Fr&&Fr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e},o=Fr&&Fr.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.initializeSearch=e.makeInitializedNNSearch=e.makeInitializations=e.makeNNDescent=void 0;var s=i(qr),a=i(Vr),l=i(Dr),c=i(Or);e.makeNNDescent=function(t,e){return function(r,n,i,o,a,l,u,h){void 0===o&&(o=10),void 0===a&&(a=50),void 0===l&&(l=.001),void 0===u&&(u=.5),void 0===h&&(h=!0);for(var f=r.length,g=s.makeHeap(r.length,i),p=0;p<r.length;p++)for(var m=s.rejectionSample(i,r.length,e),d=0;d<m.length;d++){var y=t(r[p],r[m[d]]);s.heapPush(g,p,y,m[d],1),s.heapPush(g,m[d],y,p,1)}if(h)for(var w=0;w<n.length;w++)for(p=0;p<n[w].length&&!(n[w][p]<0);p++)for(d=p+1;d<n[w].length&&!(n[w][d]<0);d++){y=t(r[n[w][p]],r[n[w][d]]);s.heapPush(g,n[w][p],y,n[w][d],1),s.heapPush(g,n[w][d],y,n[w][p],1)}for(w=0;w<o;w++){var v=s.buildCandidates(g,f,i,a,e),b=0;for(p=0;p<f;p++)for(d=0;d<a;d++){var x=Math.floor(v[0][p][d]);if(!(x<0||c.tauRand(e)<u))for(var M=0;M<a;M++){var _=Math.floor(v[0][p][M]),S=v[2][p][d],k=v[2][p][M];if(!(_<0||!S&&!k)){y=t(r[x],r[_]);b+=s.heapPush(g,x,y,_,1),b+=s.heapPush(g,_,y,x,1)}}}if(b<=l*i*r.length)break}return s.deheapSort(g)}},e.makeInitializations=function(t){return{initFromRandom:function(e,r,n,i,o){for(var a=0;a<n.length;a++)for(var l=c.rejectionSample(e,r.length,o),u=0;u<l.length;u++)if(!(l[u]<0)){var h=t(r[l[u]],n[a]);s.heapPush(i,a,h,l[u],1)}},initFromTree:function(e,r,n,i,o){for(var a=0;a<n.length;a++)for(var c=l.searchFlatTree(n[a],e,o),u=0;u<c.length;u++){if(c[u]<0)return;var h=t(r[c[u]],n[a]);s.heapPush(i,a,h,c[u],1)}}}},e.makeInitializedNNSearch=function(t){return function(e,r,n,i){for(var l,c,u=a.getCSR(r),h=u.indices,f=u.indptr,g=0;g<i.length;g++)for(var p=new Set(n[0][g]);;){var m=s.smallestFlagged(n,g);if(-1===m)break;var d=h.slice(f[m],f[m+1]);try{for(var y=(l=void 0,o(d)),w=y.next();!w.done;w=y.next()){var v=w.value;if(v!==m&&-1!==v&&!p.has(v)){var b=t(e[v],i[g]);s.uncheckedHeapPush(n,g,b,v,1),p.add(v)}}}catch(t){l={error:t}}finally{try{w&&!w.done&&(c=y.return)&&c.call(y)}finally{if(l)throw l.error}}}return n}},e.initializeSearch=function(t,e,r,n,i,a,l){var c,u,h=s.makeHeap(r.length,n);if(i(n,e,r,h,l),t)try{for(var f=o(t),g=f.next();!g.done;g=f.next()){a(g.value,e,r,h,l)}}catch(t){c={error:t}}finally{try{g&&!g.done&&(u=f.return)&&u.call(f)}finally{if(c)throw c.error}}return h}}));const Ur=Object.prototype.toString;function Hr(t){return Ur.call(t).endsWith("Array]")}function Yr(t,e,r){let n=0;const i=r(e);for(let e=0;e<t.x.length;e++)n+=Math.abs(t.y[e]-i(t.x[e]));return n}function Xr(t,e,r,n,i){let o=r*n*n,s=Mr.eye(e.length,e.length,o);const a=i(e);let l=new Float64Array(t.x.length);for(let e=0;e<t.x.length;e++)l[e]=a(t.x[e]);let c=function(t,e,r,n,i){const o=r.length,s=t.x.length;let a=new Array(o);for(let l=0;l<o;l++){a[l]=new Array(s);let o=r.slice();o[l]+=n;let c=i(o);for(let r=0;r<s;r++)a[l][r]=e[r]-c(t.x[r])}return new Mr(a)}(t,l,e,n,i),u=function(t,e){const r=t.x.length;let n=new Array(r);for(let i=0;i<r;i++)n[i]=[t.y[i]-e[i]];return new Mr(n)}(t,l),h=Cr(s.add(c.mmul(c.transpose())));return(e=(e=new Mr([e])).sub(h.mmul(c).mmul(u).mul(n).transpose())).to1DArray()}var Br,Wr=(Br=Object.freeze({__proto__:null,default:function(t,e,r={}){let{maxIterations:n=100,gradientDifference:i=.1,damping:o=0,errorTolerance:s=.01,minValues:a,maxValues:l,initialValues:c}=r;if(o<=0)throw new Error("The damping option must be a positive number");if(!t.x||!t.y)throw new Error("The data parameter must have x and y elements");if(!Hr(t.x)||t.x.length<2||!Hr(t.y)||t.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(t.x.length!==t.y.length)throw new Error("The data parameter elements must have the same size");let u=c||new Array(e.length).fill(1),h=u.length;if(l=l||new Array(h).fill(Number.MAX_SAFE_INTEGER),a=a||new Array(h).fill(Number.MIN_SAFE_INTEGER),l.length!==a.length)throw new Error("minValues and maxValues must be the same size");if(!Hr(u))throw new Error("initialValues must be an array");let f,g=Yr(t,u,e),p=g<=s;for(f=0;f<n&&!p;f++){u=Xr(t,u,o,i,e);for(let t=0;t<h;t++)u[t]=Math.min(Math.max(a[t],u[t]),l[t]);if(g=Yr(t,u,e),isNaN(g))break;p=g<=s}return{parameterValues:u,parameterError:g,iterations:f}}}))&&Br.default||Br,Gr=jr((function(t,e){var r=Fr&&Fr.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),n=Fr&&Fr.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=Fr&&Fr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e},o=Fr&&Fr.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}l((n=n.apply(t,e||[])).next())}))},s=Fr&&Fr.__generator||function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=Fr&&Fr.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},l=Fr&&Fr.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t},c=Fr&&Fr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.initTransform=e.resetLocalConnectivity=e.fastIntersection=e.findABParams=e.cosine=e.euclidean=e.UMAP=void 0;var u=i(qr),h=i(Vr),f=i(Lr),g=i(Dr),p=i(Or),m=c(Wr),d=1e-5,y=.001,w=function(){function t(t){var e=this;void 0===t&&(t={}),this.learningRate=1,this.localConnectivity=1,this.minDist=.1,this.nComponents=2,this.nEpochs=0,this.nNeighbors=15,this.negativeSampleRate=5,this.random=Math.random,this.repulsionStrength=1,this.setOpMixRatio=1,this.spread=1,this.transformQueueSize=4,this.targetMetric="categorical",this.targetWeight=.5,this.targetNNeighbors=this.nNeighbors,this.distanceFn=v,this.isInitialized=!1,this.rpForest=[],this.embedding=[],this.optimizationState=new b;var r=function(r){void 0!==t[r]&&(e[r]=t[r])};r("distanceFn"),r("learningRate"),r("localConnectivity"),r("minDist"),r("nComponents"),r("nEpochs"),r("nNeighbors"),r("negativeSampleRate"),r("random"),r("repulsionStrength"),r("setOpMixRatio"),r("spread"),r("transformQueueSize")}return t.prototype.fit=function(t){return this.initializeFit(t),this.optimizeLayout(),this.embedding},t.prototype.fitAsync=function(t,e){return void 0===e&&(e=function(){return!0}),o(this,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return this.initializeFit(t),[4,this.optimizeLayoutAsync(e)];case 1:return r.sent(),[2,this.embedding]}}))}))},t.prototype.setSupervisedProjection=function(t,e){void 0===e&&(e={}),this.Y=t,this.targetMetric=e.targetMetric||this.targetMetric,this.targetWeight=e.targetWeight||this.targetWeight,this.targetNNeighbors=e.targetNNeighbors||this.targetNNeighbors},t.prototype.setPrecomputedKNN=function(t,e){this.knnIndices=t,this.knnDistances=e},t.prototype.initializeFit=function(t){if(t.length<=this.nNeighbors)throw new Error("Not enough data points ("+t.length+") to create nNeighbors: "+this.nNeighbors+".  Add more data points or adjust the configuration.");if(this.X===t&&this.isInitialized)return this.getNEpochs();if(this.X=t,!this.knnIndices&&!this.knnDistances){var e=this.nearestNeighbors(t);this.knnIndices=e.knnIndices,this.knnDistances=e.knnDistances}this.graph=this.fuzzySimplicialSet(t,this.nNeighbors,this.setOpMixRatio),this.makeSearchFns(),this.searchGraph=this.makeSearchGraph(t),this.processGraphForSupervisedProjection();var r=this.initializeSimplicialSetEmbedding(),n=r.head,i=r.tail,o=r.epochsPerSample;return this.optimizationState.head=n,this.optimizationState.tail=i,this.optimizationState.epochsPerSample=o,this.initializeOptimization(),this.prepareForOptimizationLoop(),this.isInitialized=!0,this.getNEpochs()},t.prototype.makeSearchFns=function(){var t=f.makeInitializations(this.distanceFn),e=t.initFromTree,r=t.initFromRandom;this.initFromTree=e,this.initFromRandom=r,this.search=f.makeInitializedNNSearch(this.distanceFn)},t.prototype.makeSearchGraph=function(t){for(var e=this.knnIndices,r=this.knnDistances,n=[t.length,t.length],i=new h.SparseMatrix([],[],[],n),o=0;o<e.length;o++)for(var s=e[o],a=r[o],l=0;l<s.length;l++){var c=s[l],u=a[l];u>0&&i.set(o,c,u)}var f=h.transpose(i);return h.maximum(i,f)},t.prototype.transform=function(t){var e=this,r=this.X;if(void 0===r||0===r.length)throw new Error("No data has been fit.");var n=Math.floor(this.nNeighbors*this.transformQueueSize);n=Math.min(r.length,n);var i=f.initializeSearch(this.rpForest,r,t,n,this.initFromRandom,this.initFromTree,this.random),o=this.search(r,this.searchGraph,i,t),s=u.deheapSort(o),a=s.indices,l=s.weights;a=a.map((function(t){return t.slice(0,e.nNeighbors)})),l=l.map((function(t){return t.slice(0,e.nNeighbors)}));var c=Math.max(0,this.localConnectivity-1),g=this.smoothKNNDistance(l,this.nNeighbors,c),m=g.sigmas,d=g.rhos,y=this.computeMembershipStrengths(a,l,m,d),w=y.rows,v=y.cols,b=y.vals,x=[t.length,r.length],M=new h.SparseMatrix(w,v,b,x),_=h.normalize(M,"l1"),S=h.getCSR(_),k=t.length,N=E(p.reshape2d(S.indices,k,this.nNeighbors),p.reshape2d(S.values,k,this.nNeighbors),this.embedding),A=this.nEpochs?this.nEpochs/3:M.nRows<=1e4?100:30,R=M.getValues().reduce((function(t,e){return e>t?e:t}),0);M=M.map((function(t){return t<R/A?0:t})),M=h.eliminateZeros(M);var C=this.makeEpochsPerSample(M.getValues(),A),P=M.getRows(),z=M.getCols();return this.assignOptimizationStateParameters({headEmbedding:N,tailEmbedding:this.embedding,head:P,tail:z,currentEpoch:0,nEpochs:A,nVertices:M.getDims()[1],epochsPerSample:C}),this.prepareForOptimizationLoop(),this.optimizeLayout()},t.prototype.processGraphForSupervisedProjection=function(){var t=this.Y,e=this.X;if(t){if(t.length!==e.length)throw new Error("Length of X and y must be equal");if("categorical"===this.targetMetric){var r=this.targetWeight<1?1/(1-this.targetWeight)*2.5:1e12;this.graph=this.categoricalSimplicialSetIntersection(this.graph,t,r)}}},t.prototype.step=function(){var t=this.optimizationState.currentEpoch;return t<this.getNEpochs()&&this.optimizeLayoutStep(t),this.optimizationState.currentEpoch},t.prototype.getEmbedding=function(){return this.embedding},t.prototype.nearestNeighbors=function(t){var e=this.distanceFn,r=this.nNeighbors,n=f.makeNNDescent(e,this.random),i=5+Math.floor(function(t){return.5===t?0:Math.round(t)}(Math.pow(t.length,.5)/20)),o=Math.max(5,Math.floor(Math.round(function(t){return Math.log(t)/Math.log(2)}(t.length))));this.rpForest=g.makeForest(t,r,i,this.random);var s=n(t,g.makeLeafArray(this.rpForest),r,o);return{knnIndices:s.indices,knnDistances:s.weights}},t.prototype.fuzzySimplicialSet=function(t,e,r){void 0===r&&(r=1);var n=this,i=n.knnIndices,o=void 0===i?[]:i,s=n.knnDistances,a=void 0===s?[]:s,l=n.localConnectivity,c=this.smoothKNNDistance(a,e,l),u=c.sigmas,f=c.rhos,g=this.computeMembershipStrengths(o,a,u,f),p=g.rows,m=g.cols,d=g.vals,y=[t.length,t.length],w=new h.SparseMatrix(p,m,d,y),v=h.transpose(w),b=h.pairwiseMultiply(w,v),x=h.subtract(h.add(w,v),b),M=h.multiplyScalar(x,r),_=h.multiplyScalar(b,1-r);return h.add(M,_)},t.prototype.categoricalSimplicialSetIntersection=function(t,e,r,n){void 0===n&&(n=1);var i=S(t,e,n,r);return k(i=h.eliminateZeros(i))},t.prototype.smoothKNNDistance=function(t,e,r,n,i){void 0===r&&(r=1),void 0===n&&(n=64),void 0===i&&(i=1);for(var o=Math.log(e)/Math.log(2)*i,s=p.zeros(t.length),a=p.zeros(t.length),l=0;l<t.length;l++){var c=0,u=1/0,h=1,f=t[l],g=f.filter((function(t){return t>0}));if(g.length>=r){var m=Math.floor(r),w=r-m;m>0?(s[l]=g[m-1],w>d&&(s[l]+=w*(g[m]-g[m-1]))):s[l]=w*g[0]}else g.length>0&&(s[l]=p.max(g));for(var v=0;v<n;v++){for(var b=0,x=1;x<t[l].length;x++){var M=t[l][x]-s[l];b+=M>0?Math.exp(-M/h):1}if(Math.abs(b-o)<d)break;b>o?h=(c+(u=h))/2:(c=h,u===1/0?h*=2:h=(c+u)/2)}if(a[l]=h,s[l]>0){var _=p.mean(f);a[l]<y*_&&(a[l]=y*_)}else{var S=p.mean(t.map(p.mean));a[l]<y*S&&(a[l]=y*S)}}return{sigmas:a,rhos:s}},t.prototype.computeMembershipStrengths=function(t,e,r,n){for(var i=t.length,o=t[0].length,s=p.zeros(i*o),a=p.zeros(i*o),l=p.zeros(i*o),c=0;c<i;c++)for(var u=0;u<o;u++){var h=0;-1!==t[c][u]&&(h=t[c][u]===c?0:e[c][u]-n[c]<=0?1:Math.exp(-(e[c][u]-n[c])/r[c]),s[c*o+u]=c,a[c*o+u]=t[c][u],l[c*o+u]=h)}return{rows:s,cols:a,vals:l}},t.prototype.initializeSimplicialSetEmbedding=function(){for(var t=this,e=this.getNEpochs(),r=this.nComponents,n=this.graph.getValues(),i=0,o=0;o<n.length;o++){var s=n[o];i<n[o]&&(i=s)}var a=this.graph.map((function(t){return t<i/e?0:t}));this.embedding=p.zeros(a.nRows).map((function(){return p.zeros(r).map((function(){return 20*p.tauRand(t.random)-10}))}));var l=[],c=[],u=[],h=a.getAll();for(o=0;o<h.length;o++){var f=h[o];f.value&&(l.push(f.value),u.push(f.row),c.push(f.col))}return{head:c,tail:u,epochsPerSample:this.makeEpochsPerSample(l,e)}},t.prototype.makeEpochsPerSample=function(t,e){var r=p.filled(t.length,-1),n=p.max(t),i=t.map((function(t){return t/n*e}));return i.forEach((function(t,n){t>0&&(r[n]=e/i[n])})),r},t.prototype.assignOptimizationStateParameters=function(t){Object.assign(this.optimizationState,t)},t.prototype.prepareForOptimizationLoop=function(){var t=this,e=t.repulsionStrength,r=t.learningRate,n=t.negativeSampleRate,i=this.optimizationState,o=i.epochsPerSample,s=i.headEmbedding,a=i.tailEmbedding,c=s[0].length,u=s.length===a.length,h=o.map((function(t){return t/n})),f=l(h),g=l(o);this.assignOptimizationStateParameters({epochOfNextSample:g,epochOfNextNegativeSample:f,epochsPerNegativeSample:h,moveOther:u,initialAlpha:r,alpha:r,gamma:e,dim:c})},t.prototype.initializeOptimization=function(){var t=this.embedding,e=this.embedding,r=this.optimizationState,n=r.head,i=r.tail,o=r.epochsPerSample,s=this.getNEpochs(),a=this.graph.nCols,l=_(this.spread,this.minDist),c=l.a,u=l.b;this.assignOptimizationStateParameters({headEmbedding:t,tailEmbedding:e,head:n,tail:i,epochsPerSample:o,a:c,b:u,nEpochs:s,nVertices:a})},t.prototype.optimizeLayoutStep=function(t){for(var e=this.optimizationState,r=e.head,n=e.tail,i=e.headEmbedding,o=e.tailEmbedding,s=e.epochsPerSample,a=e.epochOfNextSample,l=e.epochOfNextNegativeSample,c=e.epochsPerNegativeSample,u=e.moveOther,h=e.initialAlpha,f=e.alpha,g=e.gamma,m=e.a,d=e.b,y=e.dim,w=e.nEpochs,v=e.nVertices,b=0;b<s.length;b++)if(!(a[b]>t)){var _=r[b],S=n[b],k=i[_],E=o[S],N=M(k,E),A=0;N>0&&(A=-2*m*d*Math.pow(N,d-1),A/=m*Math.pow(N,d)+1);for(var R=0;R<y;R++){var C=x(A*(k[R]-E[R]),4);k[R]+=C*f,u&&(E[R]+=-C*f)}a[b]+=s[b];for(var P=Math.floor((t-l[b])/c[b]),z=0;z<P;z++){var $=p.tauRandInt(v,this.random),I=o[$],T=M(k,I),F=0;if(T>0)F=2*g*d,F/=(.001+T)*(m*Math.pow(T,d)+1);else if(_===$)continue;for(R=0;R<y;R++){C=4;F>0&&(C=x(F*(k[R]-I[R]),4)),k[R]+=C*f}}l[b]+=P*c[b]}return e.alpha=h*(1-t/w),e.currentEpoch+=1,i},t.prototype.optimizeLayoutAsync=function(t){var e=this;return void 0===t&&(t=function(){return!0}),new Promise((function(r,n){var i=function(){return o(e,void 0,void 0,(function(){var e,o,a,l,c,u;return s(this,(function(s){try{if(e=this.optimizationState,o=e.nEpochs,a=e.currentEpoch,this.embedding=this.optimizeLayoutStep(a),l=this.optimizationState.currentEpoch,c=!1===t(l),u=l===o,c||u)return[2,r(u)];setTimeout((function(){return i()}),0)}catch(t){n(t)}return[2]}))}))};setTimeout((function(){return i()}),0)}))},t.prototype.optimizeLayout=function(t){void 0===t&&(t=function(){return!0});for(var e=!1,r=[];!e;){var n=this.optimizationState,i=n.nEpochs,o=n.currentEpoch;r=this.optimizeLayoutStep(o);var s=this.optimizationState.currentEpoch,a=!1===t(s);e=s===i||a}return r},t.prototype.getNEpochs=function(){var t=this.graph;if(this.nEpochs>0)return this.nEpochs;var e=t.nRows;return e<=2500?500:e<=5e3?400:e<=7500?300:200},t}();function v(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return Math.sqrt(r)}e.UMAP=w,e.euclidean=v,e.cosine=function(t,e){for(var r=0,n=0,i=0,o=0;o<t.length;o++)r+=t[o]*e[o],n+=Math.pow(t[o],2),i+=Math.pow(e[o],2);return 0===n&&0===i?0:0===n||0===i?1:1-r/Math.sqrt(n*i)};var b=function(){this.currentEpoch=0,this.headEmbedding=[],this.tailEmbedding=[],this.head=[],this.tail=[],this.epochsPerSample=[],this.epochOfNextSample=[],this.epochOfNextNegativeSample=[],this.epochsPerNegativeSample=[],this.moveOther=!0,this.initialAlpha=1,this.alpha=1,this.gamma=1,this.a=1.5769434603113077,this.b=.8950608779109733,this.dim=2,this.nEpochs=500,this.nVertices=0};function x(t,e){return t>e?e:t<-e?-e:t}function M(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return r}function _(t,e){var r=p.linear(0,3*t,300).map((function(t){return t<e?1:t})),n=p.zeros(r.length).map((function(n,i){return r[i]>=e?Math.exp(-(r[i]-e)/t):n})),i={x:r,y:n},o={damping:1.5,initialValues:[.5,.5],gradientDifference:.1,maxIterations:100,errorTolerance:.01},s=m.default(i,(function(t){var e=a(t,2),r=e[0],n=e[1];return function(t){return 1/(1+r*Math.pow(t,2*n))}}),o).parameterValues,l=a(s,2);return{a:l[0],b:l[1]}}function S(t,e,r,n){return void 0===r&&(r=1),void 0===n&&(n=5),t.map((function(t,i,o){return-1===e[i]||-1===e[o]?t*Math.exp(-r):e[i]!==e[o]?t*Math.exp(-n):t}))}function k(t){t=h.normalize(t,"max");var e=h.transpose(t),r=h.pairwiseMultiply(e,t);return t=h.add(t,h.subtract(e,r)),h.eliminateZeros(t)}function E(t,e,r){for(var n=p.zeros(t.length).map((function(t){return p.zeros(r[0].length)})),i=0;i<t.length;i++)for(var o=0;o<t[0].length;o++)for(var s=0;s<r[0].length;s++){var a=t[i][o];n[i][s]+=e[i][o]*r[a][s]}return n}e.findABParams=_,e.fastIntersection=S,e.resetLocalConnectivity=k,e.initTransform=E})),Kr=jr((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"UMAP",{enumerable:!0,get:function(){return Gr.UMAP}})}));class Qr{fit(t){try{const e=new Kr.UMAP({nComponents:2}).fit(t);return Array.isArray(e)?e:[]}catch(t){return console.error("Error in UMAP fit:",t),[]}}}var Zr={value:()=>{}};function Jr(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new tn(n)}function tn(t){this._=t}function en(t,e){for(var r,n=0,i=t.length;n<i;++n)if((r=t[n]).name===e)return r.value}function rn(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=Zr,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}tn.prototype=Jr.prototype={constructor:tn,on:function(t,e){var r,n,i=this._,o=(n=i,(t+"").trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),s=-1,a=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<a;)if(r=(t=o[s]).type)i[r]=rn(i[r],t.name,e);else if(null==e)for(r in i)i[r]=rn(i[r],t.name,null);return this}for(;++s<a;)if((r=(t=o[s]).type)&&(r=en(i[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new tn(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,i=new Array(r),o=0;o<r;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,r=(n=this._[t]).length;o<r;++o)n[o].value.apply(e,i)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],i=0,o=n.length;i<o;++i)n[i].value.apply(e,r)}};var nn,on,sn=0,an=0,ln=0,cn=0,un=0,hn=0,fn="object"==typeof performance&&performance.now?performance:Date,gn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function pn(){return un||(gn(mn),un=fn.now()+hn)}function mn(){un=0}function dn(){this._call=this._time=this._next=null}function yn(t,e,r){var n=new dn;return n.restart(t,e,r),n}function wn(){un=(cn=fn.now())+hn,sn=an=0;try{!function(){pn(),++sn;for(var t,e=nn;e;)(t=un-e._time)>=0&&e._call.call(void 0,t),e=e._next;--sn}()}finally{sn=0,function(){var t,e,r=nn,n=1/0;for(;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:nn=e);on=t,bn(n)}(),un=0}}function vn(){var t=fn.now(),e=t-cn;e>1e3&&(hn-=e,cn=t)}function bn(t){sn||(an&&(an=clearTimeout(an)),t-un>24?(t<1/0&&(an=setTimeout(wn,t-fn.now()-hn)),ln&&(ln=clearInterval(ln))):(ln||(cn=fn.now(),ln=setInterval(vn,1e3)),sn=1,gn(wn)))}function xn(t,e,r){var n=new dn;return e=null==e?0:+e,n.restart((r=>{n.stop(),t(r+e)}),e,r),n}dn.prototype=yn.prototype={constructor:dn,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?pn():+r)+(null==e?0:+e),this._next||on===this||(on?on._next=this:nn=this,on=this),this._call=t,this._time=r,bn()},stop:function(){this._call&&(this._call=null,this._time=1/0,bn())}};var Mn=Jr("start","end","cancel","interrupt"),_n=[];function Sn(t,e,r,n,i,o){var s=t.__transition;if(s){if(r in s)return}else t.__transition={};!function(t,e,r){var n,i=t.__transition;function o(t){r.state=1,r.timer.restart(s,r.delay,r.time),r.delay<=t&&s(t-r.delay)}function s(o){var c,u,h,f;if(1!==r.state)return l();for(c in i)if((f=i[c]).name===r.name){if(3===f.state)return xn(s);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[c]):+c<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete i[c])}if(xn((function(){3===r.state&&(r.state=4,r.timer.restart(a,r.delay,r.time),a(o))})),r.state=2,r.on.call("start",t,t.__data__,r.index,r.group),2===r.state){for(r.state=3,n=new Array(h=r.tween.length),c=0,u=-1;c<h;++c)(f=r.tween[c].value.call(t,t.__data__,r.index,r.group))&&(n[++u]=f);n.length=u+1}}function a(e){for(var i=e<r.duration?r.ease.call(null,e/r.duration):(r.timer.restart(l),r.state=5,1),o=-1,s=n.length;++o<s;)n[o].call(t,i);5===r.state&&(r.on.call("end",t,t.__data__,r.index,r.group),l())}function l(){for(var n in r.state=6,r.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=r,r.timer=yn(o,0,r.time)}(t,r,{name:e,index:n,group:i,on:Mn,tween:_n,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function kn(t,e){var r=Nn(t,e);if(r.state>0)throw new Error("too late; already scheduled");return r}function En(t,e){var r=Nn(t,e);if(r.state>3)throw new Error("too late; already running");return r}function Nn(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function An(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function Rn(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Cn(){}var Pn=.7,zn=1/Pn,$n="\\s*([+-]?\\d+)\\s*",In="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Tn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Fn=/^#([0-9a-f]{3,8})$/,jn=new RegExp(`^rgb\\(${$n},${$n},${$n}\\)$`),On=new RegExp(`^rgb\\(${Tn},${Tn},${Tn}\\)$`),qn=new RegExp(`^rgba\\(${$n},${$n},${$n},${In}\\)$`),Vn=new RegExp(`^rgba\\(${Tn},${Tn},${Tn},${In}\\)$`),Dn=new RegExp(`^hsl\\(${In},${Tn},${Tn}\\)$`),Ln=new RegExp(`^hsla\\(${In},${Tn},${Tn},${In}\\)$`),Un={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Hn(){return this.rgb().formatHex()}function Yn(){return this.rgb().formatRgb()}function Xn(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Fn.exec(t))?(r=e[1].length,e=parseInt(e[1],16),6===r?Bn(e):3===r?new Kn(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===r?Wn(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===r?Wn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=jn.exec(t))?new Kn(e[1],e[2],e[3],1):(e=On.exec(t))?new Kn(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=qn.exec(t))?Wn(e[1],e[2],e[3],e[4]):(e=Vn.exec(t))?Wn(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Dn.exec(t))?ri(e[1],e[2]/100,e[3]/100,1):(e=Ln.exec(t))?ri(e[1],e[2]/100,e[3]/100,e[4]):Un.hasOwnProperty(t)?Bn(Un[t]):"transparent"===t?new Kn(NaN,NaN,NaN,0):null}function Bn(t){return new Kn(t>>16&255,t>>8&255,255&t,1)}function Wn(t,e,r,n){return n<=0&&(t=e=r=NaN),new Kn(t,e,r,n)}function Gn(t,e,r,n){return 1===arguments.length?((i=t)instanceof Cn||(i=Xn(i)),i?new Kn((i=i.rgb()).r,i.g,i.b,i.opacity):new Kn):new Kn(t,e,r,null==n?1:n);var i}function Kn(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}function Qn(){return`#${ei(this.r)}${ei(this.g)}${ei(this.b)}`}function Zn(){const t=Jn(this.opacity);return`${1===t?"rgb(":"rgba("}${ti(this.r)}, ${ti(this.g)}, ${ti(this.b)}${1===t?")":`, ${t})`}`}function Jn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ti(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ei(t){return((t=ti(t))<16?"0":"")+t.toString(16)}function ri(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new ii(t,e,r,n)}function ni(t){if(t instanceof ii)return new ii(t.h,t.s,t.l,t.opacity);if(t instanceof Cn||(t=Xn(t)),!t)return new ii;if(t instanceof ii)return t;var e=(t=t.rgb()).r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),o=Math.max(e,r,n),s=NaN,a=o-i,l=(o+i)/2;return a?(s=e===o?(r-n)/a+6*(r<n):r===o?(n-e)/a+2:(e-r)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new ii(s,a,l,t.opacity)}function ii(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}function oi(t){return(t=(t||0)%360)<0?t+360:t}function si(t){return Math.max(0,Math.min(1,t||0))}function ai(t,e,r){return 255*(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)}An(Cn,Xn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Hn,formatHex:Hn,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return ni(this).formatHsl()},formatRgb:Yn,toString:Yn}),An(Kn,Gn,Rn(Cn,{brighter(t){return t=null==t?zn:Math.pow(zn,t),new Kn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Pn:Math.pow(Pn,t),new Kn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Kn(ti(this.r),ti(this.g),ti(this.b),Jn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qn,formatHex:Qn,formatHex8:function(){return`#${ei(this.r)}${ei(this.g)}${ei(this.b)}${ei(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Zn,toString:Zn})),An(ii,(function(t,e,r,n){return 1===arguments.length?ni(t):new ii(t,e,r,null==n?1:n)}),Rn(Cn,{brighter(t){return t=null==t?zn:Math.pow(zn,t),new ii(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Pn:Math.pow(Pn,t),new ii(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new Kn(ai(t>=240?t-240:t+120,i,n),ai(t,i,n),ai(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new ii(oi(this.h),si(this.s),si(this.l),Jn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Jn(this.opacity);return`${1===t?"hsl(":"hsla("}${oi(this.h)}, ${100*si(this.s)}%, ${100*si(this.l)}%${1===t?")":`, ${t})`}`}}));var li=t=>()=>t;function ci(t){return 1===(t=+t)?ui:function(e,r){return r-e?function(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}(e,r,t):li(isNaN(e)?r:e)}}function ui(t,e){var r=e-t;return r?function(t,e){return function(r){return t+r*e}}(t,r):li(isNaN(t)?e:t)}var hi=function t(e){var r=ci(e);function n(t,e){var n=r((t=Gn(t)).r,(e=Gn(e)).r),i=r(t.g,e.g),o=r(t.b,e.b),s=ui(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=i(e),t.b=o(e),t.opacity=s(e),t+""}}return n.gamma=t,n}(1);function fi(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}var gi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pi=new RegExp(gi.source,"g");function mi(t,e){var r,n,i,o=gi.lastIndex=pi.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(r=gi.exec(t))&&(n=pi.exec(e));)(i=n.index)>o&&(i=e.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(n=n[0])?a[s]?a[s]+=n:a[++s]=n:(a[++s]=null,l.push({i:s,x:fi(r,n)})),o=pi.lastIndex;return o<e.length&&(i=e.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var r,n=0;n<e;++n)a[(r=l[n]).i]=r.x(t);return a.join("")})}var di,yi=180/Math.PI,wi={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function vi(t,e,r,n,i,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*r+e*n)&&(r-=t*l,n-=e*l),(a=Math.sqrt(r*r+n*n))&&(r/=a,n/=a,l/=a),t*n<e*r&&(t=-t,e=-e,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*yi,skewX:Math.atan(l)*yi,scaleX:s,scaleY:a}}function bi(t,e,r,n){function i(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],l=[];return o=t(o),s=t(s),function(t,n,i,o,s,a){if(t!==i||n!==o){var l=s.push("translate(",null,e,null,r);a.push({i:l-4,x:fi(t,i)},{i:l-2,x:fi(n,o)})}else(i||o)&&s.push("translate("+i+e+o+r)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(t,e,r,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:r.push(i(r)+"rotate(",null,n)-2,x:fi(t,e)})):e&&r.push(i(r)+"rotate("+e+n)}(o.rotate,s.rotate,a,l),function(t,e,r,o){t!==e?o.push({i:r.push(i(r)+"skewX(",null,n)-2,x:fi(t,e)}):e&&r.push(i(r)+"skewX("+e+n)}(o.skewX,s.skewX,a,l),function(t,e,r,n,o,s){if(t!==r||e!==n){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:fi(t,r)},{i:a-2,x:fi(e,n)})}else 1===r&&1===n||o.push(i(o)+"scale("+r+","+n+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(t){for(var e,r=-1,n=l.length;++r<n;)a[(e=l[r]).i]=e.x(t);return a.join("")}}}var xi=bi((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?wi:vi(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Mi=bi((function(t){return null==t?wi:(di||(di=document.createElementNS("http://www.w3.org/2000/svg","g")),di.setAttribute("transform",t),(t=di.transform.baseVal.consolidate())?vi((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):wi)}),", ",")",")");function _i(t,e){var r,n;return function(){var i=En(this,t),o=i.tween;if(o!==r)for(var s=0,a=(n=r=o).length;s<a;++s)if(n[s].name===e){(n=n.slice()).splice(s,1);break}i.tween=n}}function Si(t,e,r){var n,i;if("function"!=typeof r)throw new Error;return function(){var o=En(this,t),s=o.tween;if(s!==n){i=(n=s).slice();for(var a={name:e,value:r},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=a;break}l===c&&i.push(a)}o.tween=i}}function ki(t,e,r){var n=t._id;return t.each((function(){var t=En(this,n);(t.value||(t.value={}))[e]=r.apply(this,arguments)})),function(t){return Nn(t,n).value[e]}}function Ei(t,e){var r;return("number"==typeof e?fi:e instanceof Xn?hi:(r=Xn(e))?(e=r,hi):mi)(t,e)}function Ni(t){return function(){this.removeAttribute(t)}}function Ai(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ri(t,e,r){var n,i,o=r+"";return function(){var s=this.getAttribute(t);return s===o?null:s===n?i:i=e(n=s,r)}}function Ci(t,e,r){var n,i,o=r+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===n?i:i=e(n=s,r)}}function Pi(t,e,r){var n,i,o;return function(){var s,a,l=r(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===n&&a===i?o:(i=a,o=e(n=s,l));this.removeAttribute(t)}}function zi(t,e,r){var n,i,o;return function(){var s,a,l=r(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===n&&a===i?o:(i=a,o=e(n=s,l));this.removeAttributeNS(t.space,t.local)}}function $i(t,e){var r,n;function i(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&function(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}(t,i)),r}return i._value=e,i}function Ii(t,e){var r,n;function i(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&function(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}(t,i)),r}return i._value=e,i}function Ti(t,e){return function(){kn(this,t).delay=+e.apply(this,arguments)}}function Fi(t,e){return e=+e,function(){kn(this,t).delay=e}}function ji(t,e){return function(){En(this,t).duration=+e.apply(this,arguments)}}function Oi(t,e){return e=+e,function(){En(this,t).duration=e}}var qi=pt.prototype.constructor;function Vi(t){return function(){this.style.removeProperty(t)}}var Di=0;function Li(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function Ui(t){return pt().transition(t)}function Hi(){return++Di}var Yi=pt.prototype;Li.prototype=Ui.prototype={constructor:Li,select:function(t){var e=this._name,r=this._id;"function"!=typeof t&&(t=u(t));for(var n=this._groups,i=n.length,o=new Array(i),s=0;s<i;++s)for(var a,l,c=n[s],h=c.length,f=o[s]=new Array(h),g=0;g<h;++g)(a=c[g])&&(l=t.call(a,a.__data__,g,c))&&("__data__"in a&&(l.__data__=a.__data__),f[g]=l,Sn(f[g],e,r,g,f,Nn(a,r)));return new Li(o,this._parents,e,r)},selectAll:function(t){var e=this._name,r=this._id;"function"!=typeof t&&(t=f(t));for(var n=this._groups,i=n.length,o=[],s=[],a=0;a<i;++a)for(var l,c=n[a],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var g,p=t.call(l,l.__data__,h,c),m=Nn(l,r),d=0,y=p.length;d<y;++d)(g=p[d])&&Sn(g,e,r,d,p,m);o.push(p),s.push(l)}return new Li(o,s,e,r)},selectChild:Yi.selectChild,selectChildren:Yi.selectChildren,filter:function(t){"function"!=typeof t&&(t=p(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var o,s=e[i],a=s.length,l=n[i]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new Li(n,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,i=r.length,o=Math.min(n,i),s=new Array(n),a=0;a<o;++a)for(var l,c=e[a],u=r[a],h=c.length,f=s[a]=new Array(h),g=0;g<h;++g)(l=c[g]||u[g])&&(f[g]=l);for(;a<n;++a)s[a]=e[a];return new Li(s,this._parents,this._name,this._id)},selection:function(){return new qi(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,r=Hi(),n=this._groups,i=n.length,o=0;o<i;++o)for(var s,a=n[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=Nn(s,e);Sn(s,t,r,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Li(n,this._parents,t,r)},call:Yi.call,nodes:Yi.nodes,node:Yi.node,size:Yi.size,empty:Yi.empty,each:Yi.each,on:function(t,e){var r=this._id;return arguments.length<2?Nn(this.node(),r).on.on(t):this.each(function(t,e,r){var n,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?kn:En;return function(){var s=o(this,t),a=s.on;a!==n&&(i=(n=a).copy()).on(e,r),s.on=i}}(r,t,e))},attr:function(t,e){var r=o(t),n="transform"===r?Mi:Ei;return this.attrTween(t,"function"==typeof e?(r.local?zi:Pi)(r,n,ki(this,"attr."+t,e)):null==e?(r.local?Ai:Ni)(r):(r.local?Ci:Ri)(r,n,e))},attrTween:function(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;var n=o(t);return this.tween(r,(n.local?$i:Ii)(n,e))},style:function(t,e,r){var n="transform"==(t+="")?xi:Ei;return null==e?this.styleTween(t,function(t,e){var r,n,i;return function(){var o=j(this,t),s=(this.style.removeProperty(t),j(this,t));return o===s?null:o===r&&s===n?i:i=e(r=o,n=s)}}(t,n)).on("end.style."+t,Vi(t)):"function"==typeof e?this.styleTween(t,function(t,e,r){var n,i,o;return function(){var s=j(this,t),a=r(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=j(this,t)),s===l?null:s===n&&l===i?o:(i=l,o=e(n=s,a))}}(t,n,ki(this,"style."+t,e))).each(function(t,e){var r,n,i,o,s="style."+e,a="end."+s;return function(){var l=En(this,t),c=l.on,u=null==l.value[s]?o||(o=Vi(e)):void 0;c===r&&i===u||(n=(r=c).copy()).on(a,i=u),l.on=n}}(this._id,t)):this.styleTween(t,function(t,e,r){var n,i,o=r+"";return function(){var s=j(this,t);return s===o?null:s===n?i:i=e(n=s,r)}}(t,n,e),r).on("end.style."+t,null)},styleTween:function(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return this.tween(n,function(t,e,r){var n,i;function o(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&function(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}(t,o,r)),n}return o._value=e,o}(t,e,null==r?"":r))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(ki(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,r;function n(){var n=t.apply(this,arguments);return n!==r&&(e=(r=n)&&function(t){return function(e){this.textContent=t.call(this,e)}}(n)),e}return n._value=t,n}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n,i=Nn(this.node(),r).tween,o=0,s=i.length;o<s;++o)if((n=i[o]).name===t)return n.value;return null}return this.each((null==e?_i:Si)(r,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Ti:Fi)(e,t)):Nn(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ji:Oi)(e,t)):Nn(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){En(this,t).ease=e}}(e,t)):Nn(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var r=e.apply(this,arguments);if("function"!=typeof r)throw new Error;En(this,t).ease=r}}(this._id,t))},end:function(){var t,e,r=this,n=r._id,i=r.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0===--i&&o()}};r.each((function(){var r=En(this,n),i=r.on;i!==t&&((e=(t=i).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),r.on=e})),0===i&&o()}))},[Symbol.iterator]:Yi[Symbol.iterator]};var Xi={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Bi(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function Wi(t,e){if("object"==typeof t){for(var r in t)n(this,r,t[r]);return this}return"function"==typeof t?this.each(function(t){return function(){var e=t.apply(this,arguments);for(var r in e)n(mt(this),r,e[r])}}(t)):1==arguments.length?this.style(t):n(this,t,e);function n(t,e,r){e=e.replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase();var n;return~"top left bottom right padding-top padding-left padding-bottom padding-right border-top b-width border-left-width border-botto-width m border-right-width margin-top margin-left margin-bottom margin-right font-size width stroke-width line-height margin padding border border-radius max-width min-width max-height min-height".indexOf(e)?t.style(e,"function"==typeof r?(n=r,function(){return i(n.apply(this,arguments))}):i(r)):t.style(e,r),t}function i(t){return t.match?t:t+"px"}}pt.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var r,n,i,o=t.__transition,s=!0;if(o){for(i in e=null==e?null:e+"",o)(r=o[i]).name===e?(n=r.state>2&&r.state<5,r.state=6,r.timer.stop(),r.on.call(n?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete o[i]):s=!1;s&&delete t.__transition}}(this,t)}))},pt.prototype.transition=function(t){var e,r;t instanceof Li?(e=t._id,t=t._name):(e=Hi(),(r=Xi).time=pn(),t=null==t?null:t+"");for(var n=this._groups,i=n.length,o=0;o<i;++o)for(var s,a=n[o],l=a.length,c=0;c<l;++c)(s=a[c])&&Sn(s,t,e,c,a,r||Bi(s,e));return new Li(n,this._parents,t,e)},pt.prototype.styles=Wi,Ui.prototype.styles=Wi;var Gi={metadata:r,dimensions:[{id:"dimensions",name:"Dimensions",validTypes:["number"],required:!0,multiple:!0,operation:"get"},{id:"labels",name:"Hover Labels",validTypes:["string","number"],required:!1},{id:"groups",name:"Groups",validTypes:["string","number"],required:!1}],mapData:{dimensions:"get",groups:"get",labels:"get"},render:function(t,r,n,i,o){console.error("In render function");const{width:s,height:a,marginLeft:l,marginRight:c,marginBottom:u,marginTop:h,background:f,dotsRadius:g,colorScale:p,title:m,epsilon:d,perplexity:y,tickLabelsVisible:w,analysisMethod:v}=n,{titleSize:b,boundWidth:x,boundHeight:M,boundLeft:_,boundTop:S,xAccessor:k,yAccessor:E,reducedDimensions:N,reducedDimensionsClassified:A}=function(){const t=a/30;let n=s-l-c,i=a-h-u,o=l+12,f=i>=300?h+t:h;i>=300&&(i-=t);const{reducedDimensions:g,reducedDimensionsClassified:p}=function(){let t,n;const i=r.map((t=>t.dimensions));if("PCA"===v){t=(new Tr).fit(i)}else if("UMAP"===v){t=(new Qr).fit(i)}else if("FDP"===v){const n=r.map(((t,e)=>({id:e}))),i=function(t){const e=[],r=5;for(let n=0;n<t.length;n++)for(let i=n+1;i<n+r+1&&i<t.length;i++)e.push({source:n,target:i});return e}(r);console.log("links = "),console.log(i),console.log("Nodes ="),console.log(n);const o=function(t,r,n,i){const o=e.forceSimulation(t).force("link",e.forceLink(r).id((t=>t.id)).distance(50)).force("charge",e.forceManyBody().strength(-30)).force("center",e.forceCenter(n/2,i/2)).stop();for(let t=0;t<300;++t)o.tick();return t}(n,i,s,a);console.log("Result ="),console.log(o),t=o}else{const e=(new Tr).fit(i),r=rr({dim:2,epsilon:d,perplexity:y,seed:1234});r.initDataRaw(e);for(let t=0;t<500;t++)r.step();t=r.getSolution()}return n=t.map(((t,e)=>{let n,i;return r[e]&&r[e].groups&&(n=r[e].groups),r[e]&&r[e].labels&&(i=r[e].labels),{reducedDimension:t,groups:n,label:i}})),{reducedDimensions:t,reducedDimensionsClassified:n}}();return{minTitleHeight:300,titleSize:t,boundWidth:n,boundHeight:i,boundLeft:o,boundTop:f,xAccessor:t=>t[0],yAccessor:t=>t[1],reducedDimensions:g,reducedDimensionsClassified:p}}(),R=N.map((t=>t[0])),C=N.map((t=>t[1])),P=mt(t),z=function(){P.append("rect").attr("width",s).attr("height",a).attr("fill",f),b&&P.append("text").text(m).attr("x",s/2).attr("y",h).style("text-anchor","middle").attr("font-size",b);return P.append("g").attr("transform",`translate(${_}, ${S})`)}(),{xScale:$,yScale:I}=function(){const t=er().domain(Mt(R)).range([0,x]).nice(),e=er().domain(Mt(C)).range([M,0]).nice();return{xScale:t,yScale:e}}();!function(){const t=Tt(4,r).scale(I).tickFormat(Xt(".1e")),e=z.append("g").call(t).attr("text-anchor","left");var r;e.attr("transform","translate(0, 0)"),e.selectAll("text").attr("transform","translate(0, 0)").style("text-anchor","end");const n=function(t){return Tt(3,t)}().scale($).tickFormat(Xt(".1e")),i=z.append("g").call(n).attr("transform",`translate(0, ${M})`);w||(e.selectAll("text").remove(),i.selectAll("text").remove())}(),function(){const t=z.selectAll("circle").data(A);t.join("circle").attr("cx",(t=>$(k(t.reducedDimension)))).attr("cy",(t=>I(E(t.reducedDimension)))).attr("r",g).attr("fill",(t=>t.groups?p(t.groups):"#0365a8")).on("mouseover",(function(t,e){const r=t.target.cx.animVal.value,n=t.target.cy.animVal.value-20;z.append("text").attr("x",r).attr("y",n).attr("font-size",30).attr("class","similarity-map-point-label").text(e.label),console.log(e.label)})).on("mouseout",(function(t,e){z.select(".similarity-map-point-label").remove()}))}()},visualOptions:{title:{type:"text",label:"Chart title",default:"",group:"artboard"},marginTop:{type:"number",label:"Margin (top)",default:50,group:"artboard"},marginRight:{type:"number",label:"Margin (right)",default:50,group:"artboard"},marginBottom:{type:"number",label:"Margin (bottom)",default:50,group:"artboard"},marginLeft:{type:"number",label:"Margin (left)",default:50,group:"artboard"},analysisMethod:{type:"text",label:"Reduction Method",options:[{label:"PCA",value:"PCA"},{label:"UMAP",value:"UMAP"},{label:"t-SNE",value:"TSNE"},{label:"FDP",value:"FDP"}],default:"PCA",group:"Dimensionality Reduction"},epsilon:{type:"number",label:"Epsilon",default:10,group:"t-SNE",disabled:{analysisMethod:"PCA"}},perplexity:{type:"number",label:"Perplexity",default:30,group:"t-SNE",disabled:{analysisMethod:"PCA"}},dotsRadius:{type:"number",label:"Dots radius",default:5,group:"chart"},colorScale:{type:"colorScale",label:"Color scale",dimension:"groups",default:{scaleType:"ordinal",interpolator:"interpolateSpectral"},group:"color"}},styles:{axisLabel:{fontFamily:"Arial, sans-serif",fontSize:"12px",fill:"#7b7b7b",fontWeight:"bold"},axisLine:{stroke:"#ccc"},labelPrimary:{fontFamily:"Arial, sans-serif",fontSize:"10px",fill:"black",fontWeight:"bold"},labelSecondary:{fontFamily:"Arial, sans-serif",fontSize:"10px",fill:"black",fontWeight:"normal"},labelItalic:{fontFamily:"Arial, sans-serif",fontSize:"10px",fill:"black",fontWeight:"normal",fontStyle:"italic"},seriesLabel:{fontFamily:"Arial, sans-serif",fontSize:"12px",fill:"black",fontWeight:"bold",dominantBaseline:"hanging"},labelOutline:{strokeWidth:"2px",paintOrder:"stroke",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"}}};t.default=Gi,Object.defineProperty(t,"__esModule",{value:!0})}));
